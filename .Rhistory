ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, fill = as.factor(clust_6), col = as.factor(clust_6)))+
geom_point(shape = 21, stroke = 0, alpha = 0.3, size = 1)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Нас-е в 2010 г. к нас-ю в 2002 г., %",
breaks = seq(0, 150, 25))+
scale_x_continuous(name = "Центральность по близости (6 кластеров)",
breaks = seq(-2, 4, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
# legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.box = "horizontal")+
guides(fill = FALSE)
# Центральность по посредничеству (6) vs Динамика населения
betw_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = betw_CL6, col = as.factor(clust_6)))+
geom_point(alpha = 0.3, stroke = 0, size = 1)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Нас-е в 2010 г. к нас-ю в 2002 г., %",
breaks = seq(0, 150, 25))+
scale_x_continuous(name = "Центральность по посредничеству",
breaks = seq(-2, 6, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12))+
guides(colour = guide_legend(title.position = "top", nrow = 1))
# Извлечем легенду
color_legend <- g_legend(betw_CL6_vs_popDyn)
# Совместим графики
par(mar=c(0,0,0,0))
gg <-
ggplot()+
coord_equal(xlim = c(0, 10), ylim = c(0, 11), expand = c(0.1,0.1))+
annotation_custom(ggplotGrob(clo_CL6_vs_popDyn +
guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 6, ymax = 11)+
annotation_custom(ggplotGrob(betw_CL6_vs_popDyn + guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 1, ymax = 6)+
annotation_custom(color_legend,
xmin = 2, xmax = 5, ymin = 0, ymax = 1)+
labs(x = NULL, y = NULL)+
theme_void()
# Сохраним графики
ggsave(filename = "Fig10.jpeg", path = "plots/", dpi = 200,
plot = gg, device = "jpeg", width = 6, height = 7)
# Центральность по посредничеству (6) vs Динамика населения
betw_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = betw_CL6, col = as.factor(clust_6)))+
geom_point(alpha = 0.3, stroke = 0, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Нас-е в 2010 г. к нас-ю в 2002 г., %",
breaks = seq(0, 150, 25))+
scale_x_continuous(name = "Центральность по посредничеству",
breaks = seq(-2, 6, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12))+
guides(colour = guide_legend(title.position = "top", nrow = 1))
# Центральность по близости (6) vs Динамика населения
clo_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, fill = as.factor(clust_6), col = as.factor(clust_6)))+
geom_point(shape = 21, stroke = 0, alpha = 0.3, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Нас-е в 2010 г. к нас-ю в 2002 г., %",
breaks = seq(0, 150, 25))+
scale_x_continuous(name = "Центральность по близости (6 кластеров)",
breaks = seq(-2, 4, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
# legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.box = "horizontal")+
guides(fill = FALSE)
# Центральность по посредничеству (6) vs Динамика населения
betw_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = betw_CL6, col = as.factor(clust_6)))+
geom_point(alpha = 0.3, stroke = 0, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Нас-е в 2010 г. к нас-ю в 2002 г., %",
breaks = seq(0, 150, 25))+
scale_x_continuous(name = "Центральность по посредничеству",
breaks = seq(-2, 6, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12))+
guides(colour = guide_legend(title.position = "top", nrow = 1))
# Извлечем легенду
color_legend <- g_legend(betw_CL6_vs_popDyn)
# Совместим графики
par(mar=c(0,0,0,0))
gg <-
ggplot()+
coord_equal(xlim = c(0, 10), ylim = c(0, 11), expand = c(0.1,0.1))+
annotation_custom(ggplotGrob(clo_CL6_vs_popDyn +
guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 6, ymax = 11)+
annotation_custom(ggplotGrob(betw_CL6_vs_popDyn + guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 1, ymax = 6)+
annotation_custom(color_legend,
xmin = 2, xmax = 5, ymin = 0, ymax = 1)+
labs(x = NULL, y = NULL)+
theme_void()
# Сохраним графики
ggsave(filename = "Fig10.jpeg", path = "plots/", dpi = 200,
plot = gg, device = "jpeg", width = 6, height = 7)
# Центральность по близости (6) vs Динамика населения
clo_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, fill = as.factor(clust_6), col = as.factor(clust_6)))+
geom_point(shape = 21, stroke = 0, alpha = 0.4, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Нас-е в 2010 г. к нас-ю в 2002 г., %",
breaks = seq(0, 150, 25))+
scale_x_continuous(name = "Центральность по близости (6 кластеров)",
breaks = seq(-2, 4, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
# legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.box = "horizontal")+
guides(fill = FALSE)
# Центральность по посредничеству (6) vs Динамика населения
betw_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = betw_CL6, col = as.factor(clust_6)))+
geom_point(alpha = 0.4, stroke = 0, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Нас-е в 2010 г. к нас-ю в 2002 г., %",
breaks = seq(0, 150, 25))+
scale_x_continuous(name = "Центральность по посредничеству",
breaks = seq(-2, 6, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12))+
guides(colour = guide_legend(title.position = "top", nrow = 1))
# Извлечем легенду
color_legend <- g_legend(betw_CL6_vs_popDyn)
# Совместим графики
par(mar=c(0,0,0,0))
gg <-
ggplot()+
coord_equal(xlim = c(0, 10), ylim = c(0, 11), expand = c(0.1,0.1))+
annotation_custom(ggplotGrob(clo_CL6_vs_popDyn +
guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 6, ymax = 11)+
annotation_custom(ggplotGrob(betw_CL6_vs_popDyn + guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 1, ymax = 6)+
annotation_custom(color_legend,
xmin = 2, xmax = 5, ymin = 0, ymax = 1)+
labs(x = NULL, y = NULL)+
theme_void()
# Сохраним графики
ggsave(filename = "Fig10.jpeg", path = "plots/", dpi = 200,
plot = gg, device = "jpeg", width = 6, height = 7)
# Центральность по близости (6) vs Динамика населения
clo_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, fill = as.factor(clust_6), col = as.factor(clust_6)))+
geom_point(shape = 21, stroke = 0, alpha = 0.4, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Динамика населения, %",
breaks = seq(0, 150, 25))+
scale_x_continuous(name = "Центральность по близости (6 кластеров)",
breaks = seq(-2, 4, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
# legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.box = "horizontal")+
guides(fill = FALSE)
# Центральность по посредничеству (6) vs Динамика населения
betw_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = betw_CL6, col = as.factor(clust_6)))+
geom_point(alpha = 0.4, stroke = 0, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Динамика населения, %",
breaks = seq(0, 150, 25))+
scale_x_continuous(name = "Центральность по посредничеству",
breaks = seq(-2, 6, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12))+
guides(colour = guide_legend(title.position = "top", nrow = 1))
# Извлечем легенду
color_legend <- g_legend(betw_CL6_vs_popDyn)
# Совместим графики
par(mar=c(0,0,0,0))
gg <-
ggplot()+
coord_equal(xlim = c(0, 10), ylim = c(0, 11), expand = c(0.1,0.1))+
annotation_custom(ggplotGrob(clo_CL6_vs_popDyn +
guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 6, ymax = 11)+
annotation_custom(ggplotGrob(betw_CL6_vs_popDyn + guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 1, ymax = 6)+
annotation_custom(color_legend,
xmin = 2, xmax = 5, ymin = 0, ymax = 1)+
labs(x = NULL, y = NULL)+
theme_void()
# Сохраним графики
ggsave(filename = "Fig10.jpeg", path = "plots/", dpi = 200,
plot = gg, device = "jpeg", width = 6, height = 7)
ggsave(filename = "Fig10.eps", path = "plots/", dpi = 200,
plot = gg, device = "eps", width = 6, height = 7)
# Центральность по близости (6) vs Динамика населения
clo_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, fill = as.factor(clust_6), col = as.factor(clust_6)))+
geom_point(shape = 21, stroke = 0, alpha = 0.4, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Динамика населения, %",
breaks = seq(0, 150, 25))+
scale_x_continuous(name = "Центральность по близости (6 кластеров)",
breaks = seq(-2, 4, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12, base_family = "Times New Roman")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
# legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.box = "horizontal")+
guides(fill = FALSE)
# Центральность по посредничеству (6) vs Динамика населения
betw_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = betw_CL6, col = as.factor(clust_6)))+
geom_point(alpha = 0.4, stroke = 0, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Динамика населения, %",
breaks = seq(0, 150, 25))+
scale_x_continuous(name = "Центральность по посредничеству",
breaks = seq(-2, 6, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12, base_family = "Times New Roman")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12))+
guides(colour = guide_legend(title.position = "top", nrow = 1))
# Извлечем легенду
color_legend <- g_legend(betw_CL6_vs_popDyn)
# Совместим графики
par(mar=c(0,0,0,0))
gg <-
ggplot()+
coord_equal(xlim = c(0, 10), ylim = c(0, 11), expand = c(0.1,0.1))+
annotation_custom(ggplotGrob(clo_CL6_vs_popDyn +
guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 6, ymax = 11)+
annotation_custom(ggplotGrob(betw_CL6_vs_popDyn + guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 1, ymax = 6)+
annotation_custom(color_legend,
xmin = 2, xmax = 5, ymin = 0, ymax = 1)+
labs(x = NULL, y = NULL)+
theme_void()
# Сохраним графики
ggsave(filename = "Fig10.jpeg", path = "plots/", dpi = 200,
plot = gg, device = "jpeg", width = 6, height = 7)
ggsave(filename = "Fig10.eps", path = "plots/", dpi = 200,
plot = gg, device = "eps", width = 6, height = 7)
ggsave(filename = "Fig10.eps", path = "plots/", dpi = 200,
plot = gg, device = "eps", width = 6, height = 7)
gg <-
ggplot()+
coord_equal(xlim = c(0, 10), ylim = c(0, 13), expand = c(0.1,0.1))+
annotation_custom(ggplotGrob(clo_CL6_vs_popDyn +
guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 7, ymax = 13)+
annotation_custom(ggplotGrob(betw_CL6_vs_popDyn + guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 1, ymax = 7)+
annotation_custom(color_legend,
xmin = 2, xmax = 5, ymin = 0, ymax = 1)+
labs(x = NULL, y = NULL)+
theme_void()
# Сохраним графики
ggsave(filename = "Fig10.jpeg", path = "plots/", dpi = 200,
plot = gg, device = "jpeg", width = 6, height = 8)
# Центральность по близости (6) vs Динамика населения
clo_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, fill = as.factor(clust_6), col = as.factor(clust_6)))+
geom_point(shape = 21, stroke = 0, alpha = 0.4, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = name = "Население, 2010 г. к 2002 г., %",
breaks = seq(0, 150, 25))+
scale_x_continuous(name = "Центральность по близости (6 кластеров)",
breaks = seq(-2, 4, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12, base_family = "Times New Roman")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
# legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.box = "horizontal")+
guides(fill = FALSE)
# Центральность по посредничеству (6) vs Динамика населения
betw_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = betw_CL6, col = as.factor(clust_6)))+
geom_point(alpha = 0.4, stroke = 0, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Население, 2010 г. к 2002 г., %",
breaks = seq(0, 150, 25))+
scale_x_continuous(name = "Центральность по посредничеству",
breaks = seq(-2, 6, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12, base_family = "Times New Roman")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12))+
guides(colour = guide_legend(title.position = "top", nrow = 1))
# Извлечем легенду
color_legend <- g_legend(betw_CL6_vs_popDyn)
# Совместим графики
par(mar=c(0,0,0,0))
gg <-
ggplot()+
coord_equal(xlim = c(0, 10), ylim = c(0, 13), expand = c(0.1,0.1))+
annotation_custom(ggplotGrob(clo_CL6_vs_popDyn +
guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 7, ymax = 13)+
annotation_custom(ggplotGrob(betw_CL6_vs_popDyn + guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 1, ymax = 7)+
annotation_custom(color_legend,
xmin = 2, xmax = 5, ymin = 0, ymax = 1)+
labs(x = NULL, y = NULL)+
theme_void()
# Сохраним графики
ggsave(filename = "Fig10.jpeg", path = "plots/", dpi = 200,
plot = gg, device = "jpeg", width = 6, height = 8)
# Центральность по близости (6) vs Динамика населения
clo_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, fill = as.factor(clust_6), col = as.factor(clust_6)))+
geom_point(shape = 21, stroke = 0, alpha = 0.4, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = name = "Население, 2010 г. к 2002 г., %",
breaks = seq(0, 150, 25))+
scale_x_continuous(name = "Центральность по близости (6 кластеров)",
breaks = seq(-2, 4, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12, base_family = "Times New Roman")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
# legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.box = "horizontal")+
guides(fill = FALSE)
# Центральность по посредничеству (6) vs Динамика населения
betw_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = betw_CL6, col = as.factor(clust_6)))+
geom_point(alpha = 0.4, stroke = 0, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Население, 2010 г. к 2002 г., %",
breaks = seq(0, 150, 25))+
scale_x_continuous(name = "Центральность по посредничеству",
breaks = seq(-2, 6, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12, base_family = "Times New Roman")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12))+
guides(colour = guide_legend(title.position = "top", nrow = 1))
# Центральность по близости (6) vs Динамика населения
clo_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, fill = as.factor(clust_6), col = as.factor(clust_6)))+
geom_point(shape = 21, stroke = 0, alpha = 0.4, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = name = "Население, 2010 г. к 2002 г., %",
breaks = seq(0, 150, 25))+
scale_x_continuous(name = "Центральность по близости (6 кластеров)",
breaks = seq(-2, 4, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12, base_family = "Times New Roman")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
# legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.box = "horizontal")+
guides(fill = FALSE)
# Центральность по близости (6) vs Динамика населения
clo_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, fill = as.factor(clust_6), col = as.factor(clust_6)))+
geom_point(shape = 21, stroke = 0, alpha = 0.4, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Население, 2010 г. к 2002 г., %",
breaks = seq(0, 150, 25))+
scale_x_continuous(name = "Центральность по близости (6 кластеров)",
breaks = seq(-2, 4, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12, base_family = "Times New Roman")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
# legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.box = "horizontal")+
guides(fill = FALSE)
# Центральность по посредничеству (6) vs Динамика населения
betw_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = betw_CL6, col = as.factor(clust_6)))+
geom_point(alpha = 0.4, stroke = 0, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Население, 2010 г. к 2002 г., %",
breaks = seq(0, 150, 25))+
scale_x_continuous(name = "Центральность по посредничеству",
breaks = seq(-2, 6, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12, base_family = "Times New Roman")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12))+
guides(colour = guide_legend(title.position = "top", nrow = 1))
# Извлечем легенду
color_legend <- g_legend(betw_CL6_vs_popDyn)
# Совместим графики
par(mar=c(0,0,0,0))
gg <-
ggplot()+
coord_equal(xlim = c(0, 10), ylim = c(0, 13), expand = c(0.1,0.1))+
annotation_custom(ggplotGrob(clo_CL6_vs_popDyn +
guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 7, ymax = 13)+
annotation_custom(ggplotGrob(betw_CL6_vs_popDyn + guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 1, ymax = 7)+
annotation_custom(color_legend,
xmin = 2, xmax = 5, ymin = 0, ymax = 1)+
labs(x = NULL, y = NULL)+
theme_void()
# Сохраним графики
ggsave(filename = "Fig10.jpeg", path = "plots/", dpi = 200,
plot = gg, device = "jpeg", width = 6, height = 8)
# Сохраним графики
ggsave(filename = "Fig10.jpeg", path = "plots/", dpi = 200,
plot = gg, device = "jpeg", width = 6, height = 7.5)
# Сохраним графики
ggsave(filename = "Fig10.jpeg", path = "plots/", dpi = 200,
plot = gg, device = "jpeg", width = 6, height = 7)
# Сохраним графики
ggsave(filename = "Fig10.jpeg", path = "plots/", dpi = 200,
plot = gg, device = "jpeg", width = 6, height = 8)
