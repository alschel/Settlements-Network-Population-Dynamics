model_var_closeness <- lm(CL18_variance_dif ~ closeness, data = clusters_18_metrics)
model_var_betweenness <- lm(CL18_variance_dif ~ betweenness, data = clusters_18_metrics)
stargazer(model_pop_degree, model_pop_closeness, model_pop_betweenness, model_var_degree, model_var_closeness,
model_var_betweenness,
type = "text",
dep.var.labels   = c("Annual population trend, %", "ccd")
# covariate.labels = c("Dairy cattle, '000", "Overal sown area, '0000 ha", "Yield cereals, t/ha",
#                      "Distance to regional capital, 100 km"),
# column.labels = c("1991-2000 RE model", "2001-2010 FE model")
)
stargazer(model_pop_degree, model_pop_closeness, model_pop_betweenness, model_var_degree, model_var_closeness,
model_var_betweenness,
type = "text",
dep.var.labels   = c("Динамика населения, %", "Сжатие расселения (отношение вариации, %)"))
model_pop_degree
model_pop_degree %>% summary()
stargazer(model_pop_degree, model_pop_closeness, model_pop_betweenness, model_var_degree, model_var_closeness,
model_var_betweenness,
type = "text",
dep.var.labels   = c("Динамика населения, %", "Сжатие расселения (динамика вариации, %)"))
clusters_18_metrics %>%
ggplot(aes(CL18_pop2010to2002_rel))+
geom_histogram()
clusters_18_metrics %>%
ggplot(aes(CL18_pop2010to2002_rel))+
geom_density()
clusters_18_metrics %>%
ggplot(aes(CL18_variance_dif))+
geom_density()
?lm
clusters_18_metrics %>%
ggplot(aes(CL18_variance_dif))+
geom_histogram()
?glm
corrplot(cor(clusters_18_metrics %>% dplyr::select(-clust_18)), method = "number")
?visNetwork
visIgraph(g)
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(igraph)
library(tidyr)
library(dplyr)
library(visNetwork)
library(ggplot2)
library(lme4)
library(lmerTest)
library(corrplot)
library(stargazer)
load("data/Part3_res_dataset.Rdata")
knitr::opts_chunk$set(echo = TRUE)
# df %>%
#   ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, col = as.factor(clust_6)))+
#   geom_point()+
#   geom_smooth(method = "glm")
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
test2 <- glm(pop2010to2002_rel ~ betw_CL18 + clo_CL6 + clust_6 + clust_18, REML = F, data = df %>% filter(pop2010to2002_rel < 150))
test2 <- glm(pop2010to2002_rel ~ betw_CL18 + clo_CL6 + clust_6 + clust_18, data = df %>% filter(pop2010to2002_rel < 150))
summary(test2)
#
MuMIn::r.squaredGLMM(test2)
summary(test)
#
MuMIn::r.squaredGLMM(test1)
#
MuMIn::r.squaredGLMM(test)
summary(test)
summary(test2)
summary(test)
summary(test2)
test2 <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL6 + (1|clust_6/clust_18:MunicialDistrict) + (0 + clo_CL6|clust_6), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
test2 <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL6 + (1|clust_6/clust_18:MunicipalDistrict) + (0 + clo_CL6|clust_6), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test2)
#
MuMIn::r.squaredGLMM(test)
MuMIn::r.squaredGLMM(test2)
#
MuMIn::r.squaredGLMM(test)
load(file = "data/Part3_res_dataset.Rdata")
load("data/settlements.Rdata")
df %>%
dplyr:: select(-id, - lon, -lat, -ShortName, -MunicipalDistrict, -Rosstat1990, -clust_6, -clust_18, -starts_with("CL6"), -starts_with("CL18")) -> df_cleaned
df %>%
dplyr:: select(-id, - lon, -lat, -ShortName, -MunicipalDistrict, -Rosstat1990, -clust_6, -clust_18, -starts_with("CL6"), -starts_with("CL18")) -> df
df %>%
dplyr:: select(-id, - lon, -lat, -ShortName, -MunicipalDistrict, -Rosstat1990, -clust_6, -clust_18, -starts_with("CL6"), -starts_with("CL18")) -> data
load(file = "data/Part3_res_dataset.Rdata")
load("data/settlements.Rdata")
df %>%
dplyr:: select(-id, - lon, -lat, -ShortName, -MunicipalDistrict, -Rosstat1990, -clust_6, -clust_18, -starts_with("CL6"), -starts_with("CL18")) -> df_cleaned
corr <- cor(df_cleaned)
corrplot(corr, method = "circle")
load(file = "data/Part3_res_dataset.Rdata")
load("data/settlements.Rdata")
df %>%
dplyr:: select(pop2010to2002_rel, clust_6, clust_18, starts_with("clo"), starts_with("betw")) -> df_cleaned
corr <- cor(df_cleaned)
corrplot(corr, method = "circle")
corrplot(corr, method = "number")
clusters_6_metrics$CL6_median_path %>% median()
clusters_18_metrics$CL6_median_path %>% median()
clusters_18_metrics$CL18_median_path %>% median()
df_cleaned %>% summary()
df_cleaned %>% filter(is.infinite(pop2010to2002_rel))
df_cleaned %>%
ggplot(aes(pop2010to2002_rel))+
geom_histogram(alpha = 0.4, binwidth = 5)+
scale_x_continuous(limits = c(-10, 400))+
theme_bw()
df_cleaned %>%
ggplot(aes(pop2010to2002_rel))+
geom_histogram(alpha = 0.4, binwidth = 5)+
# scale_x_continuous(limits = c(-10, 400))+
theme_bw()
View(df)
load(file = "data/Part3_res_dataset.Rdata")
load("data/settlements.Rdata")
df %>%
dplyr:: select(pop2010to2002_rel, clust_6, clust_18, starts_with("clo"), starts_with("betw")) -> df_cleaned
df_cleaned %>%
filter(!(res_pop_to_init_pop == 0 & nearest_center_dist < 20000 & MunicipalDistrict == "Тобольский район")) %>%
filter(!(res_pop_to_init_pop == 0 & nearest_center_dist < 20000 & MunicipalDistrict == "Тюменский район")) ->
df_cleaned
load(file = "data/Part3_res_dataset.Rdata")
load("data/settlements.Rdata")
df %>%
filter(!(pop2010to2002_rel == 0 & Census2002 > 1000 & MunicipalDistrict == "Тобольский район")) %>%
filter(!(pop2010to2002_rel == 0 & MunicipalDistrict == "Тюменский район")) %>%
dplyr:: select(pop2010to2002_rel, clust_6, clust_18, starts_with("clo"), starts_with("betw")) ->
df_cleaned
df_cleaned %>%
ggplot(aes(pop2010to2002_rel))+
geom_histogram(alpha = 0.4, binwidth = 5)+
theme_bw()
df_cleaned %>%
ggplot(aes(pop2010to2002_rel))+
geom_histogram(alpha = 0.7, binwidth = 5)+
theme_bw()
summary(df_cleaned)
df_cleaned %>%
mutate(dev = pop2010to2002_rel - median(pop2010to2002_rel)) %>%
filter(dev <= 3*mad(pop2010to2002_rel)) %>%
select(-dev)
df_cleaned %>%
mutate(dev = pop2010to2002_rel - median(pop2010to2002_rel)) %>%
filter(dev <= 3*mad(pop2010to2002_rel)) %>%
select(-dev) -> df_cleaned
df_cleaned %>%
ggplot(aes(pop2010to2002_rel))+
geom_histogram(alpha = 0.7, binwidth = 5)+
theme_bw()
model1 <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6), REML = F, data = df_cleaned))
model1 <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6), REML = F, data = df_cleaned)
summary(model1)
#
MuMIn::r.squaredGLMM(model1)
corr <- cor(df_cleaned)
corrplot(corr, method = "number")
model1 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = df_cleaned)
summary(model1)
#
MuMIn::r.squaredGLMM(model1)
# Pure metrics
dataset_1 <- df_cleaned %>%
select(pop2010to2002_rel, # объясняемая переменная (изменение населения за период)
clo_CL6,           # closeness centrality (в пределах одного из 6 кластеров)
clo_CL18,          # closeness centrality (в пределах одного из 18 кластеров)
betw_CL18,         # betweenness centrality (c максимальной длиной пути, учитываемой при вычислении в 52021.79)
clust_6, clust_18) # группирующие переменные
dataset_2 <- df_cleaned %>%
select(pop2010to2002_rel, # объясняемая переменная (изменение населения за период)
clo_CL6,           # closeness centrality (в пределах одного из 6 кластеров)
clo_CL18,          # closeness centrality (в пределах одного из 18 кластеров)
betw_CL6,          # betweenness centrality (c максимальной длиной пути, учитываемой при вычислении в 98245.06 км)
clust_6, clust_18)
# Weigted metrics
dataset_3 <- df_cleaned %>%
select(pop2010to2002_rel,
clo_w,
clo_CL6_w,
clo_CL18_w,
betw_CL18,
clust_6, clust_18)
dataset_4 <- df_cleaned %>%
select(pop2010to2002_rel,
clo_w,
clo_CL6_w,
clo_CL18_w,
betw_CL6,
clust_6, clust_18)
model2 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_2)
model2
#
MuMIn::r.squaredGLMM(model1)
summary(model2)
model3 <- lmer(pop2010to2002_rel ~ clo_w + clo_CL6_w + clo_CL18_w + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6_w|clust_6) + (0 + clo_CL18_w|clust_18), REML = F, data = dataset_3)
summary(model3)
#
MuMIn::r.squaredGLMM(model3)
summary(model3)
library(stargazer)
stargazer(model1, model2, model3, model4)
stargazer(model1, model2, model3, model4, type = "text")
model1 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_1)
model2 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_2)
model3 <- lmer(pop2010to2002_rel ~ clo_w + clo_CL6_w + clo_CL18_w + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6_w|clust_6) + (0 + clo_CL18_w|clust_18), REML = F, data = dataset_3)
model4 <- lmer(pop2010to2002_rel ~ clo_w + clo_CL6_w + clo_CL18_w + betw_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_4)
model1 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_1)
model2 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_2)
model3 <- lmer(pop2010to2002_rel ~ clo_w + clo_CL6_w + clo_CL18_w + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6_w|clust_6) + (0 + clo_CL18_w|clust_18), REML = F, data = dataset_3)
model4 <- lmer(pop2010to2002_rel ~ clo_w + clo_CL6_w + clo_CL18_w + betw_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6_w|clust_6) + (0 + clo_CL18_w|clust_18), REML = F, data = dataset_4)
stargazer(model1, model2, model3, model4, type = "text")
stargazer(model1, model2, model3, model4, type = "text")
model4
model3
model2
model1
stargazer(model1, model2, model3, model4, type = "text")
stargazer(model1, model2, type = "text")
stargazer::stargazer(model1, model2, type = "text")
stargazer::stargazer(... = model1, model2, type = "text")
?stargazer
stargazer::stargazer(... = model1, model2, type = "text")
class(model1) <- "lmerMod"
class(model3) <- "lmerMod"
class(model4) <- "lmerMod"
stargazer::stargazer(model1, model2, model3, model4, type = "text")
stargazer::stargazer(model1, model2, model3, model4, type = "text")
model3
class(model1) <- "lmerMod"
class(model3) <- "lmerMod"
class(model4) <- "lmerMod"
stargazer::stargazer(model1, model2, model3, model4, type = "text")
detach("package:lmerTest", unload=TRUE)
model1 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_1)
model2 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_2)
model3 <- lmer(pop2010to2002_rel ~ clo_w + clo_CL6_w + clo_CL18_w + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6_w|clust_6) + (0 + clo_CL18_w|clust_18), REML = F, data = dataset_3)
model4 <- lmer(pop2010to2002_rel ~ clo_w + clo_CL6_w + clo_CL18_w + betw_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6_w|clust_6) + (0 + clo_CL18_w|clust_18), REML = F, data = dataset_4)
stargazer::stargazer(model1, model2, model3, model4, type = "text")
model5 <- lmer(pop2010to2002_rel ~ clo_w + clo_CL6 + clo_CL6_w + betw_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL6_w|clust_6), REML = F, data = dataset_4)
model5 <- lmer(pop2010to2002_rel ~ clo_w + clo_CL6 + clo_CL6_w + betw_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL6_w|clust_6), REML = F, data = df_cleaned)
stargazer::stargazer(model1, model2, model3, model4, model5, type = "text")
#
MuMIn::r.squaredGLMM(model5)
?stargazer
#
MuMIn::r.squaredGLMM(model5)
#
MuMIn::r.squaredGLMM(model1)
#
MuMIn::r.squaredGLMM(model2)
#
MuMIn::r.squaredGLMM(model3)
#
MuMIn::r.squaredGLMM(model4)
#
MuMIn::r.squaredGLMM(model5)
model6 <- lmer(pop2010to2002_rel ~ clo_w + clo_CL6 + clo_CL6_w + betw_CL6 + (1|clust_6/clust_18), REML = F, data = df_cleaned)
#
MuMIn::r.squaredGLMM(model6)
#
MuMIn::r.squaredGLMM(model5)
#
MuMIn::r.squaredGLMM(model6)
View(df_cleaned)
View(df)
#
MuMIn::r.squaredGLMM(model4)
#
MuMIn::r.squaredGLMM(model1)
#
MuMIn::r.squaredGLMM(model2)
#
MuMIn::r.squaredGLMM(model1)
#
MuMIn::r.squaredGLMM(model4)
lm.beta.lmer <- function(mod) {
b <- fixef(mod)[-1]
sd.x <- apply(getME(mod,"X")[,-1],2,sd)
sd.y <- sd(getME(mod,"y"))
b*sd.x/sd.y
}
lm.beta.lmer(5)
stdCoef.merMod <- function(object) {
sdy <- sd(getME(object,"y"))
sdx <- apply(getME(object,"X"), 2, sd)
sc <- fixef(object)*sdx/sdy
se.fixef <- coef(summary(object))[,"Std. Error"]
se <- se.fixef*sdx/sdy
return(data.frame(stdcoef=sc, stdse=se))
}
stdCoef.merMod(Model5)
?getME
Model5
stdCoef.merMod(model5)
stdCoef.merMod(model1)
?scale
stdCoef.merMod(model5)
stdCoef.merMod(model1)
?getME
stdCoef.merMod(model2)
stdCoef.merMod(model3)
stdCoef.merMod(model4)
stdCoef.merMod(model5)
#
MuMIn::r.squaredGLMM(model2)
model1 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_1)
model2 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_2)
stargazer::stargazer(model1, model2, type = "text")
#
MuMIn::r.squaredGLMM(model1)
MuMIn::r.squaredGLMM(model2)
#
MuMIn::r.squaredGLMM(model1)
stdCoef.merMod(model1)
stdCoef.merMod(model1)
stdCoef.merMod(model2)
stdCoef.merMod(model1)
stdCoef.merMod(model2)
dataset_3 <- dataset_1 %>%
mutate_at(.vars = list(clo_CL6, clo_CL18), .funs = scale)
dataset_3 <- dataset_1 %>%
mutate_each(.vars = list(clo_CL6, clo_CL18), .funs = scale)
dataset_3 <- dataset_1 %>%
mutate_each(.vars = list(clo_CL6, clo_CL18), funs = scale)
dataset_3 <- dataset_1 %>%
mutate_each(.vars = c(clo_CL6, clo_CL18), funs = scale)
?mutate_at
dataset_3 <- dataset_1 %>%
mutate_each(.vars = c(clo_CL6, clo_CL18, betw_CL18), scale)
dataset_3 <- dataset_1 %>%
mutate_each(.vars = vars(clo_CL6, clo_CL18, betw_CL18), scale)
dataset_3 <- dataset_1 %>%
mutate_each(vars(clo_CL6, clo_CL18, betw_CL18), scale)
dataset_3 <- dataset_1 %>%
mutate_each(.cols(clo_CL6, clo_CL18, betw_CL18), scale)
dataset_3 <- dataset_1 %>%
mutate_each(.cols = vars(clo_CL6, clo_CL18, betw_CL18), scale)
dataset_3 <- dataset_1 %>%
mutate_at(.cols = vars(clo_CL6, clo_CL18, betw_CL18), scale)
dataset_3 <- dataset_1 %>%
mutate_at(.vars = vars(clo_CL6, clo_CL18, betw_CL18), scale)
dataset_3
dataset_3 %>% ggplot(aes(clo_CL18))+geom_density()
dataset_4 <- dataset_2 %>%
mutate_at(.vars = vars(clo_CL6, clo_CL18, betw_CL6), scale)
model_3 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_3)
model4 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_4)
stargazer::stargazer(model1, model2, model3, model4, type = "text")
model3
model3 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_3)
model4 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_4)
stargazer::stargazer(model1, model2, model3, model4, type = "text")
model1 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_1)
model1 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_1)
model3 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_3)
model4 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_4)
stargazer::stargazer(model1, model2, model3, model4, type = "text")
stdCoef.merMod(model3)
MuMIn::r.squaredGLMM(model1)
MuMIn::r.squaredGLMM(model3)
MuMIn::r.squaredGLMM(model2)
MuMIn::r.squaredGLMM(model4)
model1 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_1)
model1
model1 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_18/clust_6) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_1)
model1
model1 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_1)
model1
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyr)
library(ggplot2)
library(corrplot)
library(lme4)
library(stargazer)
load(file = "data/Part3_res_dataset.Rdata")
df %>%
filter(!(pop2010to2002_rel == 0 & Census2002 > 1000 & MunicipalDistrict == "Тобольский район")) %>%
filter(!(pop2010to2002_rel == 0 & MunicipalDistrict == "Тюменский район")) %>%
dplyr:: select(pop2010to2002_rel, clust_6, clust_18, starts_with("clo"), starts_with("betw")) ->
df_cleaned
summary(df_cleaned)
df_cleaned %>%
ggplot(aes(pop2010to2002_rel))+
geom_histogram(alpha = 0.7, binwidth = 5)+
theme_bw()
df_cleaned %>%
mutate(dev = pop2010to2002_rel - median(pop2010to2002_rel)) %>%
filter(dev <= 3*mad(pop2010to2002_rel)) %>%
select(-dev) -> df_cleaned
df_cleaned %>%
ggplot(aes(pop2010to2002_rel))+
geom_histogram(alpha = 0.7, binwidth = 5)+
theme_bw()
summary(df_cleaned)
corr <- cor(df_cleaned)
corrplot(corr, method = "number")
# Pure metrics
dataset_1 <- df_cleaned %>%
select(pop2010to2002_rel, # объясняемая переменная (изменение населения за период)
clo_CL6,           # closeness centrality (в пределах одного из 6 кластеров)
clo_CL18,          # closeness centrality (в пределах одного из 18 кластеров)
betw_CL18,         # betweenness centrality (c максимальной длиной пути, учитываемой при вычислении в 52021.79)
clust_6, clust_18) # группирующие переменные
dataset_2 <- df_cleaned %>%
select(pop2010to2002_rel, # объясняемая переменная (изменение населения за период)
clo_CL6,           # closeness centrality (в пределах одного из 6 кластеров)
clo_CL18,          # closeness centrality (в пределах одного из 18 кластеров)
betw_CL6,          # betweenness centrality (c максимальной длиной пути, учитываемой при вычислении в 98245.06 км)
clust_6, clust_18)
dataset_3 <- dataset_1 %>%
mutate_at(.vars = vars(clo_CL6, clo_CL18, betw_CL18), scale)
dataset_4 <- dataset_2 %>%
mutate_at(.vars = vars(clo_CL6, clo_CL18, betw_CL6), scale)
model1 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_1)
model2 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_2)
model3 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_3)
model4 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_4)
stargazer::stargazer(model1, model2, model3, model4, type = "text")
MuMIn::r.squaredGLMM(model2)
MuMIn::r.squaredGLMM(model4)
stdCoef.merMod(model2)
stdCoef.merMod <- function(object) {
sdy <- sd(getME(object,"y"))
sdx <- apply(getME(object,"X"), 2, sd)
sc <- fixef(object)*sdx/sdy
se.fixef <- coef(summary(object))[,"Std. Error"]
se <- se.fixef*sdx/sdy
return(data.frame(stdcoef=sc, stdse=se))
}
stdCoef.merMod(model2)
model1 <- lmer(pop2010to2002_rel ~ (1 + clo_CL6 + clo_CL18 + betw_CL18|clust_6/clust_18), REML = F, data = dataset_1)
model1
model1 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_1)
dataset_1 %>%
ggplot(aes(x = clo_CL6,  y= pop2010to2002_rel, col = clust_6))+
geom_point()
dataset_1 %>%
ggplot(aes(x = clo_CL6,  y= pop2010to2002_rel, col = as.factor(clust_6)))+
geom_point()
dataset_1 %>%
ggplot(aes(x = clo_CL6,  y= pop2010to2002_rel, col = as.factor(clust_6)))+
geom_point()+geom_smooth()
dataset_1 %>%
ggplot(aes(x = clo_CL6,  y= pop2010to2002_rel, col = as.factor(clust_6)))+
geom_point()+geom_smooth(method = "glm")
dataset_3 %>%
ggplot(aes(x = clo_CL6,  y= pop2010to2002_rel, col = as.factor(clust_6)))+
geom_point()+geom_smooth(method = "glm")
dataset_1 %>%
ggplot(aes(x = clo_CL6,  y= pop2010to2002_rel, col = as.factor(clust_6)))+
geom_point()+geom_smooth(method = "glm")
dataset_3 %>%
ggplot(aes(x = clo_CL6,  y= pop2010to2002_rel, col = as.factor(clust_6)))+
geom_point()+geom_smooth(method = "glm")
stdCoef.merMod(model2)
stdCoef.merMod(model1)
dataset_1 %>%
ggplot(aes(x = clo_CL18,  y= pop2010to2002_rel, col = as.factor(clust_18)))+
geom_point()+geom_smooth(method = "glm")
stdCoef.merMod(model2)
stdCoef.merMod(model1)
model1 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_1)
model1
model1 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (1 + clo_CL6|clust_6) + (1 + clo_CL18|clust_18), REML = F, data = dataset_1)
model1
model3 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (1 + clo_CL6|clust_6) + (1 + clo_CL18|clust_18), REML = F, data = dataset_3)
model3
model1 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (1 + clo_CL6|clust_6) + (1 + clo_CL18|clust_18), REML = F, data = dataset_1)
model1
model1 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_1)
model1
model3 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (1 + clo_CL6|clust_6) + (1 + clo_CL18|clust_18), REML = F, data = dataset_3)
model3
model1
model2 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_2)
model4 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_4)
stargazer::stargazer(model1, model2, model3, model4, type = "text")
model3 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (1 + clo_CL6|clust_6) + (1 + clo_CL18|clust_18), REML = F, data = dataset_3)
stargazer::stargazer(model1, model2, model3, model4, type = "text")
model3
model3
relaimpo::calc.relimp(dataset_1 %>% select(pop2010to2002_rel, clo_CL6, clo_CL18, betw_CL18, clust_6, clust_18),
type = c("lmg"), rela = TRUE)
relaimpo::calc.relimp(dataset_1,
type = c("lmg"), rela = TRUE)
dataset_1
relaimpo::calc.relimp(dataset_1 %>% select(pop2010to2002_rel, clo_CL6, clo_CL18, betw_CL18),
type = c("lmg"), rela = TRUE)
broom::tidy(model1, effects = "fixed",
conf.int = TRUE,
conf.method = "profile")
stdCoef.merMod(model2)
stdCoef.merMod(model1)
df %>%
ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, col = as.factor(clust_6)))+
geom_point()+
geom_smooth(method = "glm")
stdCoef.merMod(model2)
model3 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18), REML = F, data = dataset_3)
stargazer::stargazer(model1, model2, model3, model4, type = "text")
model4 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL6 + (1|clust_6/clust_18), REML = F, data = dataset_4)
stargazer::stargazer(model1, model2, model3, model4, type = "text")
stargazer::stargazer(model1, model2, model3, model4, type = "text")
model1 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_1)
model2 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_2)
# model3 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL18 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_3)
# model4 <- lmer(pop2010to2002_rel ~ clo_CL6 + clo_CL18 + betw_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6) + (0 + clo_CL18|clust_18), REML = F, data = dataset_4)
stargazer::stargazer(model1, model2,
# model3, model4,
type = "text")
