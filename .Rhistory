scale_y_continuous(name = element_blank(), trans = "sqrt",  # трансформируем шкалу y
breaks = seq(0, 100000000, 2500000))+
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_bw(base_family = "Arial", base_size = 14)+
theme(panel.grid = element_blank(),
axis.ticks.y = element_line(),
# axis.ticks.x = element_blank(),
# axis.text.x = element_blank(),
axis.line.y = element_line(),
# plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"),
strip.background = element_blank())
library(ggrepel)
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey", fontface = "bold")+
geom_text_repel(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt",  # трансформируем шкалу y
breaks = seq(0, 100000000, 2500000))+
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_bw(base_family = "Arial", base_size = 14)+
theme(panel.grid = element_blank(),
axis.ticks.y = element_line(),
# axis.ticks.x = element_blank(),
# axis.text.x = element_blank(),
axis.line.y = element_line(),
# plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"),
strip.background = element_blank())
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90)+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt",  # трансформируем шкалу y
breaks = seq(0, 100000000, 2500000))+
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_bw(base_family = "Arial", base_size = 14)+
theme(panel.grid = element_blank(),
axis.ticks.y = element_line(),
# axis.ticks.x = element_blank(),
# axis.text.x = element_blank(),
axis.line.y = element_line(),
# plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"),
strip.background = element_blank())
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "both")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt",  # трансформируем шкалу y
breaks = seq(0, 100000000, 2500000))+
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_bw(base_family = "Arial", base_size = 14)+
theme(panel.grid = element_blank(),
axis.ticks.y = element_line(),
# axis.ticks.x = element_blank(),
# axis.text.x = element_blank(),
axis.line.y = element_line(),
# plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"),
strip.background = element_blank())
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "x")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt",  # трансформируем шкалу y
breaks = seq(0, 100000000, 2500000))+
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_bw(base_family = "Arial", base_size = 14)+
theme(panel.grid = element_blank(),
axis.ticks.y = element_line(),
# axis.ticks.x = element_blank(),
# axis.text.x = element_blank(),
axis.line.y = element_line(),
# plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"),
strip.background = element_blank())
labels <- data_frame(label = c("Ишим", "Тобольск", "Тюмень"),
x = c(188, 675, 1100),
y = rep(35000000, 3))
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "x")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt",  # трансформируем шкалу y
breaks = seq(0, 100000000, 2500000))+
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_bw(base_family = "Arial", base_size = 14)+
theme(panel.grid = element_blank(),
axis.ticks.y = element_line(),
# axis.ticks.x = element_blank(),
# axis.text.x = element_blank(),
axis.line.y = element_line(),
# plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"),
strip.background = element_blank())
labels <- data_frame(label = c("Ишим", "Тобольск", "Тюмень"),
x = c(188, 675, 1010),
y = rep(35000000, 3))
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "x")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt",  # трансформируем шкалу y
breaks = seq(0, 100000000, 2500000))+
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_bw(base_family = "Arial", base_size = 14)+
theme(panel.grid = element_blank(),
axis.ticks.y = element_line(),
# axis.ticks.x = element_blank(),
# axis.text.x = element_blank(),
axis.line.y = element_line(),
# plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"),
strip.background = element_blank())
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "x")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt",  # трансформируем шкалу y
breaks = seq(0, 100000000, 2500000))+
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_bw(base_family = "Arial", base_size = 14)+
theme(panel.grid = element_blank(),
axis.ticks.y = element_line(),
# axis.ticks.x = element_blank(),
# axis.text.x = element_blank(),
axis.line.y = element_line(),
# plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"),
strip.background = element_blank())
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "x")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt")+  # трансформируем шкалу y
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_bw(base_family = "Arial", base_size = 14)+
theme(panel.grid = element_blank(),
axis.ticks.x = element_line(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.line.x = element_line(),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "x")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt")+  # трансформируем шкалу y
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_minimal(base_family = "Arial", base_size = 14)+
theme(panel.grid = element_blank(),
axis.ticks.x = element_line(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.line.x = element_line(),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "x")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt")+  # трансформируем шкалу y
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_minimal(base_family = "Arial", base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks.x = element_line(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
axis.line.x = element_line(),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "x")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt")+  # трансформируем шкалу y
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_minimal(base_family = "Arial", base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks.x = element_line(),
# axis.line.x = element_line(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "x")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt")+  # трансформируем шкалу y
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_minimal(base_family = "Arial", base_size = 12)+
theme(panel.grid = element_blank(),
# axis.ticks.x = element_line(),
# axis.line.x = element_line(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "x")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt")+  # трансформируем шкалу y
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_minimal(base_family = "Arial", base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks.x = element_line(),
axis.line.x = element_line(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey30", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey30", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "x")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt")+  # трансформируем шкалу y
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_minimal(base_family = "Arial", base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks.x = element_line(),
axis.line.x = element_line(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey30", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey30", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "x")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt")+  # трансформируем шкалу y
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_minimal(base_family = "Arial", base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks.x = element_line(),
axis.line.x = element_line(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
panel.spacing.y = 0,
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey30", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey30", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "x")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt")+  # трансформируем шкалу y
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_minimal(base_family = "Arial", base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks.x = element_line(),
axis.line.x = element_line(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
panel.spacing.y = unit(c(0.1,0.1,0.1,0.1),"cm"),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey30", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey30", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "x")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt")+  # трансформируем шкалу y
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_minimal(base_family = "Arial", base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks.x = element_line(),
axis.line.x = element_line(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
panel.spacing.y = unit(c(0,0,0,0),"cm"),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey30", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey30", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "x")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt")+  # трансформируем шкалу y
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_minimal(base_family = "Arial", base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks.x = element_line(),
# axis.line.x = element_line(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey30", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey30", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "x")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt")+  # трансформируем шкалу y
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_minimal(base_family = "Arial", base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks.x = element_line(),
axis.line.x = element_line(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
# axis.ticks.x = element_line(),
# axis.line.x = element_line(),
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey30", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey30", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "x")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt")+  # трансформируем шкалу y
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_minimal(base_family = "Arial", base_size = 12)+
theme(panel.grid = element_blank(),
# axis.ticks.x = element_line(),
# axis.line.x = element_line(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
test %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey30", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey30", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "x")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt")+  # трансформируем шкалу y
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_minimal(base_family = "Arial", base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks.x = element_line(),
# axis.line.x = element_line(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
# Создадим переменную с номером одного из 18 кластеров
segment(dendro_2002) %>%
mutate(clust_18 = NA_integer_) -> my_dendro
for(i in 1:18) {
my_dendro[my_dendro$y < 2550000 & my_dendro$x >= keys_18$`min(x)`[i] & my_dendro$x <= keys_18$`max(x)`[i], 5] <- i
}
# Лейблы 3 кластеров
labels <- data_frame(label = c("Ишим", "Тобольск", "Тюмень"),
x = c(188, 675, 1015),
y = rep(35000000, 3))
dendrogram <-
my_dendro %>%
ggplot()+
geom_segment(aes(x=x, y=y , xend = xend, yend = yend, col = as.factor(clust_18)), show.legend = F)+
geom_rect(data = keys_6, aes(xmin=`min(x)`, xmax=`max(x)`, ymin=0, ymax=11000000),
col = "grey30", alpha = 0, lty = "dashed")+
geom_text(data = keys_6,
aes(label = clust_6, x = `max(x)` - 50, y = 9000000),
family = "Arial",
color = "grey30", fontface = "bold")+
geom_text_repel(data = labels, aes(label = label, x = x, y= y), angle = 90, direction = "x")+
# annotate(geom = "text", data = labels, aes(label = label, x = x, y= y), angle = 90)+
scale_y_continuous(name = element_blank(), trans = "sqrt")+  # трансформируем шкалу y
scale_x_continuous(name = element_blank(), labels = 1:18, breaks = keys_18$`mean(x)`)+
scale_colour_manual(values = c(brewer.pal(n = 8, name = "Dark2"), brewer.pal(10, "Paired")), na.value = "black")+
theme_minimal(base_family = "Arial", base_size = 12)+
theme(panel.grid = element_blank(),
axis.ticks.x = element_line(),
# axis.line.x = element_line(),
axis.ticks.y = element_blank(),
axis.text.y = element_blank(),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
dendrogram
