facet_grid(.~measure)+
theme_viod()+
theme(legend.position = "bottom")+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal"))
# Plot the graph and compare centrality measures
fortify(network_g) %>%
gather(measure, value, `ЦП`:`ЦБ`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.04, y = y + 0.04, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_color_viridis_c()+
facet_grid(.~measure)+
theme_void()+
theme(legend.position = "bottom")+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal"))
# Plot the graph and compare centrality measures
fortify(network_g) %>%
gather(measure, value, `ЦП`:`ЦБ`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.04, y = y + 0.04, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_color_viridis_c()+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = "bottom")+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal"))
# Load adjacency_matrix
m <- read_csv("data/Sample graph.csv") %>% .[,-1] %>% as.matrix()
# Create network and igraph objects
g <- graph_from_adjacency_matrix(m, mode = "undirected")
network_g <- network(m)
# Calculate centrality measures, scale them and assign to nodes of network
network_g %v% "ЦП" <- igraph::betweenness(g) %>% scale() %>% .[,1]
network_g %v% "ЦБ" <- igraph::closeness(g) %>% scale() %>% .[,1]
# Plot the graph and compare centrality measures
fortify(network_g) %>%
gather(measure, value, `ЦП`:`ЦБ`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.04, y = y + 0.04, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_color_viridis_c()+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = "bottom")+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal"))
# Plot the graph and compare centrality measures
fortify(network_g) %>%
gather(measure, value, `ЦП`:`ЦБ`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.04, y = y + 0.04, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_color_viridis_c()+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = "bottom")+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal"))
# Plot the graph and compare centrality measures
fortify(network_g) %>%
gather(measure, value, `ЦП`:`ЦБ`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.04, y = y + 0.04, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_color_viridis_c()+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = "bottom")+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal"))
# Plot the graph and compare centrality measures
fortify(network_g) %>%
gather(measure, value, `ЦП`:`ЦБ`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.04, y = y + 0.04, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_color_viridis_c()+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = "bottom")+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal"))
# Plot the graph and compare centrality measures
fortify(network_g) %>%
gather(measure, value, `ЦП`:`ЦБ`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.04, y = y + 0.04, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_color_viridis_c()+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = "bottom")+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title = element_blank()))
# Plot the graph and compare centrality measures
fortify(network_g) %>%
gather(measure, value, `ЦП`:`ЦБ`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.04, y = y + 0.04, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = "bottom")+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal"))
# Plot the graph and compare centrality measures
fortify(network_g) %>%
gather(measure, value, `ЦП`:`ЦБ`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.04, y = y + 0.04, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = "bottom")+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
# Plot the graph and compare centrality measures
fortify(network_g) %>%
gather(measure, value, `ЦП`:`ЦБ`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.04, y = y + 0.04, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = c(1,1))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
# Plot the graph and compare centrality measures
fortify(network_g) %>%
gather(measure, value, `ЦП`:`ЦБ`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.04, y = y + 0.04, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = c(0,0))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
# Plot the graph and compare centrality measures
fortify(network_g) %>%
gather(measure, value, `ЦП`:`ЦБ`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.04, y = y + 0.04, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = c(0.1,0.1))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
# Plot the graph and compare centrality measures
fortify(network_g) %>%
gather(measure, value, `ЦП`:`ЦБ`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.04, y = y + 0.04, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = c(0.1,0.05))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
# Load adjacency_matrix
m <- read_csv("data/Sample graph.csv") %>% .[,-1] %>% as.matrix()
# Create network and igraph objects
g <- graph_from_adjacency_matrix(m, mode = "undirected")
network_g <- network(m)
# Calculate centrality measures, scale them and assign to nodes of network
network_g %v% "П" <- igraph::betweenness(g) %>% scale() %>% .[,1]
network_g %v% "Б" <- igraph::closeness(g) %>% scale() %>% .[,1]
# Plot the graph and compare centrality measures
fortify(network_g) %>%
gather(measure, value, `П`:`Б`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.04, y = y + 0.04, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = c(0.1,0.05))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
# Plot the graph and compare centrality measures
sample_graph <- fortify(network_g) %>%
gather(measure, value, `П`:`Б`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.04, y = y + 0.04, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = c(0.1,0.05))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
ggsave(sample_graph, filename = "sample_graph.jpeg",
device = "jpeg", path = "plots/", dpi = 300, width = 7, height = 4)
# Plot the graph and compare centrality measures
sample_graph <- fortify(network_g) %>%
gather(measure, value, `П`:`Б`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.04, y = y + 0.04, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = c(0.1,0.05))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
ggsave(sample_graph, filename = "sample_graph.jpeg",
device = "jpeg", path = "plots/", dpi = 300, width = 7, height = 4)
# Plot the graph and compare centrality measures
sample_graph <- fortify(network_g) %>%
gather(measure, value, `П`:`Б`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.04, y = y + 0.04, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_y_continuous(expand = c(0.1,0.1,0.1,0.1))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = c(0.1,0.05))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
ggsave(sample_graph, filename = "sample_graph.jpeg",
device = "jpeg", path = "plots/", dpi = 300, width = 7, height = 4)
ggsave(sample_graph, filename = "sample_graph.jpeg",
device = "jpeg", path = "plots/", dpi = 300, width = 7, height = 4.5)
ggsave(sample_graph, filename = "sample_graph.jpeg",
device = "jpeg", path = "plots/", dpi = 300, width = 7, height = 5)
ggsave(sample_graph, filename = "sample_graph.jpeg",
device = "jpeg", path = "plots/", dpi = 300, width = 6, height = 4)
ggsave(sample_graph, filename = "sample_graph.jpeg",
device = "jpeg", path = "plots/", dpi = 300, width = 7, height = 3&5)
ggsave(sample_graph, filename = "sample_graph.jpeg",
device = "jpeg", path = "plots/", dpi = 300, width = 7, height = 3.5)
# Plot the graph and compare centrality measures
sample_graph <- fortify(network_g) %>%
gather(measure, value, `П`:`Б`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.04, y = y + 0.04, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_y_continuous(expand = c(0.1,0.1,0.1,0.1))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = c(0.1,0.1))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
ggsave(sample_graph, filename = "sample_graph.jpeg",
device = "jpeg", path = "plots/", dpi = 300, width = 7, height = 3.5)
par(margin(b = 1))
# Plot the graph and compare centrality measures
sample_graph <- fortify(network_g) %>%
gather(measure, value, `П`:`Б`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.04, y = y + 0.04, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_y_continuous(expand = c(0.1,0.1,0.1,0.1))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = c(0.1,0.1))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
ggsave(sample_graph, filename = "sample_graph.jpeg",
device = "jpeg", path = "plots/", dpi = 300, width = 7, height = 3.5)
# Plot the graph and compare centrality measures
sample_graph <- fortify(network_g) %>%
gather(measure, value, `П`:`Б`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.05, y = y + 0.05, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_y_continuous(expand = c(0.1,0.1,0.1,0.1))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = c(0.1,0.1))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
ggsave(sample_graph, filename = "sample_graph.jpeg",
device = "jpeg", path = "plots/", dpi = 300, width = 7, height = 3.5)
# Plot the graph and compare centrality measures
sample_graph <- fortify(network_g) %>%
gather(measure, value, `П`:`Б`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.1, y = y + 0.1, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_y_continuous(expand = c(0.1,0.1,0.1,0.1))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = c(0.1,0.1))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
ggsave(sample_graph, filename = "sample_graph.jpeg",
device = "jpeg", path = "plots/", dpi = 300, width = 7, height = 3.5)
# Plot the graph and compare centrality measures
sample_graph <- fortify(network_g) %>%
gather(measure, value, `П`:`Б`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.05, y = y + 0.05, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_y_continuous(expand = c(0.1,0.1,0.1,0.1))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = c(0.1,0.1))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
ggsave(sample_graph, filename = "sample_graph.jpeg",
device = "jpeg", path = "plots/", dpi = 300, width = 7, height = 3.5)
# Plot the graph and compare centrality measures
sample_graph <- fortify(network_g) %>%
gather(measure, value, `П`:`Б`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.05, y = y + 0.05, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_y_continuous(expand = c(0.1,0.1,0.1,0.1))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = c(0.1,0.1))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
ggsave(sample_graph, filename = "sample_graph.jpeg",
device = "jpeg", path = "plots/", dpi = 300, width = 7, height = 3.5)
# Plot the graph and compare centrality measures
sample_graph <- fortify(network_g) %>%
gather(measure, value, `П`:`Б`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.05, y = y + 0.05, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_y_continuous(expand = c(0.1,0.1,0.1,0.1))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_blank()+
theme(legend.position = c(0.1,0.1))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
ggsave(sample_graph, filename = "sample_graph.jpeg",
device = "jpeg", path = "plots/", dpi = 300, width = 7, height = 3.5)
# Plot the graph and compare centrality measures
sample_graph <- fortify(network_g) %>%
gather(measure, value, `П`:`Б`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.07, y = y + 0.07, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_y_continuous(expand = c(0.1,0.1,0.1,0.1))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_minimal()+
theme(legend.position = c(0.1,0.1))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
sample_graph
# Plot the graph and compare centrality measures
sample_graph <- fortify(network_g) %>%
gather(measure, value, `П`:`Б`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.07, y = y + 0.07, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_y_continuous(expand = c(0.1,0.1,0.1,0.1))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_void()+
theme(legend.position = c(0.1,0.1))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
sample_graph
# Plot the graph and compare centrality measures
sample_graph <- fortify(network_g) %>%
gather(measure, value, `П`:`Б`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.07, y = y + 0.07, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_y_continuous(expand = c(0.1,0.1,0.1,0.1))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_void(base_size = 12)+
theme(legend.position = c(0.1,0.1))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
sample_graph
# Plot the graph and compare centrality measures
sample_graph <- fortify(network_g) %>%
gather(measure, value, `П`:`Б`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.07, y = y + 0.07, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_y_continuous(expand = c(0.1,0.1,0.1,0.1))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_void(base_size = 12)+
theme(legend.position = c(0.1,0.1), strip.text = element_text(size = 14))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
sample_graph
ggsave(sample_graph, filename = "sample_graph.jpeg",
device = "jpeg", path = "plots/", dpi = 300, width = 7, height = 3.5)
# Plot the graph and compare centrality measures
sample_graph <- fortify(network_g) %>%
gather(measure, value, `П`:`Б`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.07, y = y + 0.07, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_y_continuous(expand = c(0.1,0.1,0.1,0.1))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_void(base_size = 12)+
theme(legend.position = c(0.1,0.1), strip.text = element_text(size = 14))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
ggsave(sample_graph, filename = "sample_graph.jpeg",
device = "jpeg", path = "plots/", dpi = 300, width = 7, height = 3.5)
# Plot the graph and compare centrality measures
sample_graph <- fortify(network_g) %>%
gather(measure, value, `П`:`Б`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.07, y = y + 0.07, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_y_continuous(expand = c(0.1,0.1,0.1,0.1))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_void(base_size = 12)+
theme(legend.position = c(0.1,0.1), strip.text = element_text(size = 14))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
ggsave(sample_graph, filename = "sample_graph.jpeg",
device = "jpeg", path = "plots/", dpi = 300, width = 7, height = 3.5)
# Plot the graph and compare centrality measures
sample_graph <- fortify(network_g) %>%
gather(measure, value, `П`:`Б`) %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
geom_edges(color = "grey50") +
geom_nodes(aes(size = value, color = value))+
# geom_nodes(aes(color = value), size = 5, show.legend = F)+
geom_text(aes(x = x + 0.07, y = y + 0.07, label = round(value, 1)))+
scale_size_continuous(range = c(1,8))+
scale_y_continuous(expand = c(0.1,0.1,0.1,0.1))+
scale_color_viridis_c(name = "Центральность")+
facet_grid(.~measure)+
theme_void(base_size = 12)+
theme(legend.position = c(0.1,0.1), strip.text = element_text(size = 14))+
guides(size = FALSE, colour = guide_colorbar(direction = "horizontal", title.position = "top"))
ggsave(sample_graph, filename = "sample_graph.jpeg",
device = "jpeg", path = "plots/", dpi = 300, width = 7, height = 3.5)
