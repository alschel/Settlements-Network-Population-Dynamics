scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1))
# Извлечем легенду
color_legend <- g_legend(betw_CL6_vs_popDyn)
# Совместим графики
par(mar=c(0,0,0,0))
fig_8 <- ggplot()+
coord_equal(xlim = c(0, 10), ylim = c(0, 13), expand = c(0.1,0.1))+
annotation_custom(ggplotGrob(clo_CL6_vs_popDyn +
guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 7, ymax = 13)+
annotation_custom(ggplotGrob(betw_CL6_vs_popDyn + guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 1, ymax = 7)+
annotation_custom(color_legend,
xmin = 2, xmax = 5, ymin = 0, ymax = 1)+
labs(x = NULL, y = NULL)+
theme_void()+
theme(plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
# Сохраним графики
ggsave(filename = "Fig8.jpeg", path = "plots/", dpi = 200,
plot = fig_8, device = "jpeg", width = 6, height = 8)
ggsave(plot = fig_8, filename = "Fig8.jpeg", path = "plots/Иллюстрации для статьи/",
dpi = 200, device = "jpeg", width = 18, height = 22, units = "cm")
ggsave(plot = fig_8, filename = "Fig8.jpeg", path = "plots/Иллюстрации для статьи/",
dpi = 200, device = "jpeg", width = 18, height = 21, units = "cm")
ggsave(plot = fig_8, filename = "Fig8.jpeg", path = "plots/Иллюстрации для статьи/",
dpi = 200, device = "jpeg", width = 18, height = 23, units = "cm")
ggsave(plot = fig_8, filename = "Fig8.jpeg", path = "plots/Иллюстрации для статьи/",
dpi = 200, device = "jpeg", width = 18, height = 22, units = "cm")
# Центральность по близости (6) vs Динамика населения
clo_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, fill = as.factor(clust_6), col = as.factor(clust_6)))+
geom_point(shape = 21, stroke = 0, alpha = 0.4, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Динамика числ-и населения (2010 к 2002), %",
limits = c(0, 150),
breaks = seq(0, 140, 10), labels = pop.labels)+
scale_x_continuous(name = "Центральность по близости (6 кластеров)",
breaks = seq(-2, 4, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
# legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.box = "horizontal")+
guides(fill = FALSE)
# Центральность по посредничеству (6) vs Динамика населения
betw_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = betw_CL6, col = as.factor(clust_6)))+
geom_point(alpha = 0.4, stroke = 0, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Динамика числ-и населения (2010 к 2002), %",
limits = c(0, 150),
breaks = seq(0, 140, 10), labels = pop.labels)+
scale_x_continuous(name = "Центральность по посредничеству",
breaks = seq(-2, 6, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1))
# Извлечем легенду
color_legend <- g_legend(betw_CL6_vs_popDyn)
# Совместим графики
par(mar=c(0,0,0,0))
fig_8 <- ggplot()+
coord_equal(xlim = c(0, 10), ylim = c(0, 13), expand = c(0.1,0.1))+
annotation_custom(ggplotGrob(clo_CL6_vs_popDyn +
guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 7, ymax = 13)+
annotation_custom(ggplotGrob(betw_CL6_vs_popDyn + guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 1, ymax = 7)+
annotation_custom(color_legend,
xmin = 2, xmax = 5, ymin = 0, ymax = 1)+
labs(x = NULL, y = NULL)+
theme_void()+
theme(plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
# Сохраним графики
ggsave(plot = fig_8, filename = "Fig8.jpeg", path = "plots/Иллюстрации для статьи/",
dpi = 200, device = "jpeg", width = 18, height = 22, units = "cm")
# Центральность по близости (6) vs Динамика населения
clo_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, fill = as.factor(clust_6), col = as.factor(clust_6)))+
geom_point(shape = 21, stroke = 0, alpha = 0.4, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Динамика числ-и населения (2010 к 2002), %",
limits = c(0, 150),
breaks = seq(0, 140, 10), labels = pop.labels)+
scale_x_continuous(name = "Центральность по близости (6 кластеров)",
breaks = seq(-2, 4, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
# legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.box = "horizontal",
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(fill = FALSE)
# Центральность по посредничеству (6) vs Динамика населения
betw_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = betw_CL6, col = as.factor(clust_6)))+
geom_point(alpha = 0.4, stroke = 0, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Динамика числ-и населения (2010 к 2002), %",
limits = c(0, 150),
breaks = seq(0, 140, 10), labels = pop.labels)+
scale_x_continuous(name = "Центральность по посредничеству",
breaks = seq(-2, 6, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1))
# Извлечем легенду
color_legend <- g_legend(betw_CL6_vs_popDyn)
# Совместим графики
par(mar=c(0,0,0,0))
fig_8 <- ggplot()+
coord_equal(xlim = c(0, 10), ylim = c(0, 13), expand = c(0.1,0.1))+
annotation_custom(ggplotGrob(clo_CL6_vs_popDyn +
guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 7, ymax = 13)+
annotation_custom(ggplotGrob(betw_CL6_vs_popDyn + guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 1, ymax = 7)+
annotation_custom(color_legend,
xmin = 2, xmax = 5, ymin = 0, ymax = 1)+
labs(x = NULL, y = NULL)+
theme_void()+
theme(plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
# Сохраним графики
ggsave(filename = "Fig8.jpeg", path = "plots/", dpi = 200,
plot = fig_8, device = "jpeg", width = 6, height = 8)
ggsave(plot = fig_8, filename = "Fig8.jpeg", path = "plots/Иллюстрации для статьи/",
dpi = 200, device = "jpeg", width = 18, height = 22, units = "cm")
?theme
# Центральность по близости (6) vs Динамика населения
clo_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, fill = as.factor(clust_6), col = as.factor(clust_6)))+
geom_point(shape = 21, stroke = 0, alpha = 0.4, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Динамика числ-и населения (2010 к 2002), %",
limits = c(0, 150),
breaks = seq(0, 140, 10), labels = pop.labels)+
scale_x_continuous(name = "Центральность по близости (6 кластеров)",
breaks = seq(-2, 4, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
# legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.box = "horizontal",
plot.margin=unit(c(0.1,0.3,0.1,0.1),"cm"))+
guides(fill = FALSE)
# Центральность по посредничеству (6) vs Динамика населения
betw_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = betw_CL6, col = as.factor(clust_6)))+
geom_point(alpha = 0.4, stroke = 0, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Динамика числ-и населения (2010 к 2002), %",
limits = c(0, 150),
breaks = seq(0, 140, 10), labels = pop.labels)+
scale_x_continuous(name = "Центральность по посредничеству",
breaks = seq(-2, 6, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1))
# Извлечем легенду
color_legend <- g_legend(betw_CL6_vs_popDyn)
# Совместим графики
par(mar=c(0,0,0,0))
fig_8 <- ggplot()+
coord_equal(xlim = c(0, 10), ylim = c(0, 13), expand = c(0.1,0.1))+
annotation_custom(ggplotGrob(clo_CL6_vs_popDyn +
guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 7, ymax = 13)+
annotation_custom(ggplotGrob(betw_CL6_vs_popDyn + guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 1, ymax = 7)+
annotation_custom(color_legend,
xmin = 2, xmax = 5, ymin = 0, ymax = 1)+
labs(x = NULL, y = NULL)+
theme_void()+
theme(plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
# Сохраним графики
ggsave(filename = "Fig8.jpeg", path = "plots/", dpi = 200,
plot = fig_8, device = "jpeg", width = 6, height = 8)
# Сохраним графики
ggsave(plot = fig_8, filename = "Fig8.jpeg", path = "plots/Иллюстрации для статьи/",
dpi = 200, device = "jpeg", width = 18, height = 22, units = "cm")
# Центральность по близости (6) vs Динамика населения
clo_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, fill = as.factor(clust_6), col = as.factor(clust_6)))+
geom_point(shape = 21, stroke = 0, alpha = 0.4, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Динамика числ-и населения (2010 к 2002), %",
limits = c(0, 150),
breaks = seq(0, 140, 10), labels = pop.labels)+
scale_x_continuous(name = "Центральность по близости (6 кластеров)",
breaks = seq(-2, 4, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
# legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
legend.box = "horizontal",
plot.margin=unit(c(0.1,0.1,0.3,0.1),"cm"))+
guides(fill = FALSE)
# Центральность по посредничеству (6) vs Динамика населения
betw_CL6_vs_popDyn <- df_cleaned %>%
ggplot(aes(y = pop2010to2002_rel, x = betw_CL6, col = as.factor(clust_6)))+
geom_point(alpha = 0.4, stroke = 0, size = 1.2)+
geom_smooth(method = "glm", se = F)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
scale_y_continuous(name = "Динамика числ-и населения (2010 к 2002), %",
limits = c(0, 150),
breaks = seq(0, 140, 10), labels = pop.labels)+
scale_x_continuous(name = "Центральность по посредничеству",
breaks = seq(-2, 6, 1))+
scale_fill_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 12, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1))
# Извлечем легенду
color_legend <- g_legend(betw_CL6_vs_popDyn)
# Совместим графики
par(mar=c(0,0,0,0))
fig_8 <- ggplot()+
coord_equal(xlim = c(0, 10), ylim = c(0, 13), expand = c(0.1,0.1))+
annotation_custom(ggplotGrob(clo_CL6_vs_popDyn +
guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 7, ymax = 13)+
annotation_custom(ggplotGrob(betw_CL6_vs_popDyn + guides(colour = FALSE)),
xmin = 0, xmax = 10, ymin = 1, ymax = 7)+
annotation_custom(color_legend,
xmin = 2, xmax = 5, ymin = 0, ymax = 1)+
labs(x = NULL, y = NULL)+
theme_void()+
theme(plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))
# Сохраним графики
ggsave(plot = fig_8, filename = "Fig8.jpeg", path = "plots/Иллюстрации для статьи/",
dpi = 200, device = "jpeg", width = 18, height = 22, units = "cm")
cowplot::ggsave(plot = fig_8, filename = "Fig8.eps", path = "plots/Иллюстрации для статьи/",
width = 18, height = 22, units = "cm", device = cairo_ps)
corrplot(corr, method = "number", type = "full", insig = "p-value")
# Проверка предикторов на корреляцию
corr <- cor(df_cleaned %>% select(-clust_6, -clust_18, -Census2002))
colnames(corr) <- c("Динамика числ. нас-я", "ЦБ(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)", "log(числ. нас-я)")
corrplot(corr, method = "number", type = "full", insig = "p-value")
rownames(corr) <- c("Динамика числ. нас-я", "ЦБ(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)", "log(числ. нас-я)")
corrplot(corr, method = "number", type = "full", insig = "p-value")
colnames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%", "ЦБ(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)", "log(числ. нас-я)")
corrplot(corr, method = "number", type = "full", insig = "p-value")
rownames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%", "ЦБ(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)", "log(числ. нас-я)")
corrplot(corr, method = "number", type = "full", insig = "p-value")
df_cleaned
# Проверка предикторов на корреляцию
corr <- cor(df_cleaned %>% select(pop2010to2002_rel, logPop, clo_CL6, clo_CL18, betw_CL6, betw_CL18))
colnames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%","log(числ. нас-я, 2002)", "ЦБ(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)")
rownames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%","log(числ. нас-я, 2002)", "ЦБ(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)")
corrplot(corr, method = "number", type = "full", insig = "p-value")
corrplot(corr, method = "number", type = "full", insig = "p-value", col = viridis::magma())
corrplot(corr, method = "number", type = "full", insig = "p-value", col = viridis::magma(n = 12))
corrplot(corr, method = "number", type = "full", insig = "p-value", col = "black")
postscript("plots/Иллюстрации для статьи/test.eps", height=8, width=8, paper="special",
family="Helvetica", fonts="Helvetica", horizontal=FALSE, onefile=FALSE)
corrplot(corr, method = "number", type = "full", insig = "p-value", col = viridis::inferno(12))
dev.off()
corrplot(corr, method = "circle", type = "full", insig = "p-value", col = viridis::inferno(12))
corr
corrplot(corr, method = "number", type = "full", insig = "p-value", col = viridis::inferno(12))
# Проверка предикторов на корреляцию
corr <- cor(df_cleaned %>% select(pop2010to2002_rel, logPop, clo_CL6, clo_CL18, betw_CL6, betw_CL18))
# colnames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%","log(числ. нас-я, 2002)", "ЦБ(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)")
# rownames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%","log(числ. нас-я, 2002)", "Ц0Б(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)")
corrplot(corr, method = "number", type = "full", insig = "p-value", col = viridis::inferno(12))
# colnames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%","log(числ. нас-я, 2002)", "ЦБ(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)")
# rownames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%","log(числ. нас-я, 2002)", "Ц0Б(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)")
corrplot(corr, method = "number", type = "full", insig = "p-value", col = brewer.pal(12, "RYlBu"))
# colnames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%","log(числ. нас-я, 2002)", "ЦБ(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)")
# rownames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%","log(числ. нас-я, 2002)", "Ц0Б(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)")
corrplot(corr, method = "number", type = "full", insig = "p-value", col = brewer.pal(12, "RYlBl"))
# colnames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%","log(числ. нас-я, 2002)", "ЦБ(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)")
# rownames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%","log(числ. нас-я, 2002)", "Ц0Б(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)")
corrplot(corr, method = "number", type = "full", insig = "p-value", col = brewer.pal(12, "RdYlBl"))
# colnames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%","log(числ. нас-я, 2002)", "ЦБ(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)")
# rownames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%","log(числ. нас-я, 2002)", "Ц0Б(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)")
corrplot(corr, method = "number", type = "full", insig = "p-value", col = brewer.pal(12, "RdYlBu"))
# colnames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%","log(числ. нас-я, 2002)", "ЦБ(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)")
# rownames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%","log(числ. нас-я, 2002)", "Ц0Б(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)")
corrplot(corr, method = "number", type = "full", insig = "p-value", col = brewer.pal(10, "RdYlBu"))
# colnames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%","log(числ. нас-я, 2002)", "ЦБ(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)")
# rownames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%","log(числ. нас-я, 2002)", "Ц0Б(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)")
corrplot(corr, method = "number", type = "full", insig = "p-value", col = viridis::inferno(12))
library(dplyr)
library(ggplot2)
# Загрузка данных
load(file = "data/Part3_res_dataset.Rdata")
# Удалим населенные пункты, которые исчезли в результате поглощения городами
df %>%
filter(!(pop2010to2002_rel == 0 & Census2002 > 1000 & MunicipalDistrict == "Тобольский район")) %>%
filter(!(pop2010to2002_rel == 0 & MunicipalDistrict == "Тюменский район")) %>%
# Выделим из набора данных интересующие нас предикторы
dplyr::select(clust_6, clust_18, Census2002, pop2010to2002_rel, starts_with("clo"), starts_with("betw"), -ends_with("w"), - clo) ->
df_cleaned
# Удалим выбросы за пределами 3 медианных абсолютных отклонений
df_cleaned %>%
mutate(dev = pop2010to2002_rel - median(pop2010to2002_rel)) %>%
filter(dev <= 3*mad(pop2010to2002_rel)) %>%
dplyr::select(-dev) -> df_cleaned
# Plot
# Y-axis labels
pop.labels <- seq(0, 140, 10)
pop.labels[-seq(1, 16, 2)] <- ''
# Y-axis labels
pop.labels <- seq(0, 140, 10)
pop.labels[-seq(1, 16, 2)] <- ''
# plot
df_cleaned %>%
ggplot(aes(x = Census2002, y = pop2010to2002_rel))+
geom_point(alpha = 0.4, stroke = 0, size = 1.2)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
geom_smooth(method = "glm", se = F, col = "red")+
scale_x_continuous(name = "Численность населения (2002), чел.",
trans = "log", breaks = c(0, 20, 100, 400, 5000, 100000, 500000))+
scale_y_continuous(name = "Динамика числ-и нас-я (2010 к 2002), %",
limits = c(0, 150),
breaks = seq(0, 140, 10), labels = pop.labels)+
theme_bw(base_size = 12, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line())
# plot
fig_A2 <- df_cleaned %>%
ggplot(aes(x = Census2002, y = pop2010to2002_rel))+
geom_point(alpha = 0.4, stroke = 0, size = 1.2)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
geom_smooth(method = "glm", se = F, col = "red")+
scale_x_continuous(name = "Численность населения (2002), чел.",
trans = "log", breaks = c(0, 20, 100, 400, 5000, 100000, 500000))+
scale_y_continuous(name = "Динамика числ-и нас-я (2010 к 2002), %",
limits = c(0, 150),
breaks = seq(0, 140, 10), labels = pop.labels)+
theme_bw(base_size = 12, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line())
# Сохраним график
ggsave(plot = fig_A2, filename = "FigA2.jpeg", path = "plots/Иллюстрации для статьи/",
dpi = 200, device = "jpeg", width = 18, height = 12, units = "cm")
# plot
fig_A2 <- df_cleaned %>%
ggplot(aes(x = Census2002, y = pop2010to2002_rel))+
geom_point(alpha = 0.4, stroke = 0, size = 1.2)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
geom_smooth(method = "glm", se = F, col = "red")+
scale_x_continuous(name = "Численность населения (2002), чел.",
trans = "log", breaks = c(0, 20, 100, 400, 5000, 100000, 500000),
labels = c(0, 20, 100, 400, 5000, 100000, 500000))+
scale_y_continuous(name = "Динамика числ-и нас-я (2010 к 2002), %",
limits = c(0, 150),
breaks = seq(0, 140, 10), labels = pop.labels)+
theme_bw(base_size = 12, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line())
# Сохраним график
ggsave(plot = fig_A2, filename = "FigA2.jpeg", path = "plots/Иллюстрации для статьи/",
dpi = 200, device = "jpeg", width = 18, height = 12, units = "cm")
# plot
fig_A2 <- df_cleaned %>%
ggplot(aes(x = Census2002, y = pop2010to2002_rel))+
geom_point(alpha = 0.4, stroke = 0, size = 1.2)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
geom_smooth(method = "glm", se = F, col = "red")+
scale_x_continuous(name = "Численность населения (2002), чел.",
trans = "log", breaks = c(0, 20, 100, 400, 5000, 100000, 500000),
labels = c("0", "20", "100", "400", "5000", "100000", "500000"))+
scale_y_continuous(name = "Динамика числ-и нас-я (2010 к 2002), %",
limits = c(0, 150),
breaks = seq(0, 140, 10), labels = pop.labels)+
theme_bw(base_size = 12, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line())
# Сохраним график
ggsave(plot = fig_A2, filename = "FigA2.jpeg", path = "plots/Иллюстрации для статьи/",
dpi = 200, device = "jpeg", width = 18, height = 12, units = "cm")
# plot
fig_A2 <- df_cleaned %>%
ggplot(aes(x = Census2002, y = pop2010to2002_rel))+
geom_point(alpha = 0.4, stroke = 0, size = 1.2)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
geom_smooth(method = "glm", se = F, col = "red")+
scale_x_continuous(name = "Численность населения (2002), чел.",
trans = "log", breaks = c(0, 20, 100, 500, 5000, 100000, 500000),
labels = c("0", "20", "100", "500", "5000", "100000", "500000"))+
scale_y_continuous(name = "Динамика числ-и нас-я (2010 к 2002), %",
limits = c(0, 150),
breaks = seq(0, 140, 10), labels = pop.labels)+
theme_bw(base_size = 12, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line())
# Сохраним график
ggsave(plot = fig_A2, filename = "FigA2.jpeg", path = "plots/Иллюстрации для статьи/",
dpi = 200, device = "jpeg", width = 18, height = 12, units = "cm")
# plot
fig_A2 <- df_cleaned %>%
ggplot(aes(x = Census2002, y = pop2010to2002_rel))+
geom_point(alpha = 0.4, stroke = 0, size = 1.2)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
geom_smooth(method = "glm", se = F, col = "red")+
scale_x_continuous(name = "Численность населения (2002), чел.",
trans = "log", breaks = c(0, 20, 100, 500, 5000, 50000, 500000),
labels = c("0", "20", "100", "500", "5000", "50000", "500000"))+
scale_y_continuous(name = "Динамика числ-и нас-я (2010 к 2002), %",
limits = c(0, 150),
breaks = seq(0, 140, 10), labels = pop.labels)+
theme_bw(base_size = 12, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line())
# Сохраним график
ggsave(plot = fig_A2, filename = "FigA2.jpeg", path = "plots/Иллюстрации для статьи/",
dpi = 200, device = "jpeg", width = 18, height = 12, units = "cm")
# plot
fig_A2 <- df_cleaned %>%
ggplot(aes(x = Census2002, y = pop2010to2002_rel))+
geom_point(alpha = 0.4, stroke = 0, size = 1.2)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
geom_smooth(method = "glm", se = F, col = "red")+
scale_x_continuous(name = "Численность населения (2002), чел.",
trans = "log", breaks = c(0, 20, 100, 1000, 10000, 100000, 500000),
labels = c("0", "20", "100", "1000", "10000", "100000", "500000"))+
scale_y_continuous(name = "Динамика числ-и нас-я (2010 к 2002), %",
limits = c(0, 150),
breaks = seq(0, 140, 10), labels = pop.labels)+
theme_bw(base_size = 12, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line())
# Сохраним график
ggsave(plot = fig_A2, filename = "FigA2.jpeg", path = "plots/Иллюстрации для статьи/",
dpi = 200, device = "jpeg", width = 18, height = 12, units = "cm")
# plot
fig_A2 <- df_cleaned %>%
ggplot(aes(x = Census2002, y = pop2010to2002_rel))+
geom_point(alpha = 0.4, stroke = 0, size = 1.2)+
geom_hline(aes(yintercept = 100), linetype = "dashed", col = "grey3")+
geom_smooth(method = "glm", se = F, col = "red")+
scale_x_continuous(name = "Численность населения (2002), чел.",
trans = "log", breaks = c(0, 10, 100, 1000, 10000, 100000, 500000),
labels = c("0", "10", "100", "1000", "10000", "100000", "500000"))+
scale_y_continuous(name = "Динамика числ-и нас-я (2010 к 2002), %",
limits = c(0, 150),
breaks = seq(0, 140, 10), labels = pop.labels)+
theme_bw(base_size = 12, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line())
# Сохраним график
ggsave(plot = fig_A2, filename = "FigA2.jpeg", path = "plots/Иллюстрации для статьи/",
dpi = 200, device = "jpeg", width = 18, height = 12, units = "cm")
cor(df_cleaned$Census2002, df_cleaned$pop2010to2002_rel)
# Сохраним график
ggsave(plot = fig_A2, filename = "FigA2.jpeg", path = "plots/Иллюстрации для статьи/",
dpi = 200, device = "jpeg", width = 18, height = 10, units = "cm")
# Сохраним график
ggsave(plot = fig_A2, filename = "FigA2.jpeg", path = "plots/Иллюстрации для статьи/",
dpi = 200, device = "jpeg", width = 18, height = 11, units = "cm")
cowplot::ggsave(plot = fig_A2, filename = "FigA2.eps", path = "plots/Иллюстрации для статьи/",
width = 18, height = 11, units = "cm", device = cairo_ps)
