install.packages("spdep")
library("spdep", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(igraph)
library(tidyr)
library(dplyr)
library(visNetwork)
m <- read_csv("data/18clusters_matrix.csv")
View(m)
View(m)
m <- read_csv("data/18clusters_matrix.csv") %>% .[,-1]
m
rownames(m) <- 1:18
m <- read_csv("data/18clusters_matrix.csv") %>% .[,-1] %>% matrix()
m
m <- read_csv("data/18clusters_matrix.csv") %>% .[,-1] %>% as.matrix()
View(m)
graph(m)
?graph
graph_from_adjacency_matrix(m, mode = "undirected")
g <- graph_from_adjacency_matrix(m, mode = "undirected")
betweenness(g)
load("data/Part3_res_dataset.Rdata")
clusters_18_metrics
clusters_18_metrics %>%
mutate(betweenness = betweenness(g),
closeness = closeness(g)) -> clusters_18_metrics
betweenness(g)
betweenness(g) %>% str
betweenness(g) %>% str()
?
betweenness
closeness(g)
clusters_18_metrics %>%
mutate(betweenness = betweenness(g),
closeness = closeness(g))
clusters_18_metrics %>%
dplyr::mutate(betweenness = betweenness(g),
closeness = closeness(g)) -> clusters_18_metrics
as.vector(betweenness(g))
clusters_18_metrics %>%
dplyr::mutate(betweenness = as.vector(betweenness(g)),
closeness = closeness(g)) -> clusters_18_metrics
clusters_18_metrics
clusters_18_metrics %>%
dplyr::mutate(betweenness = 1)
clusters_18_metrics %>%
dplyr::mutate(betweenness = betweenness(g))
clusters_18_metrics %>%
mutate(betweenness = betweenness(g))
clusters_18_metrics %>%
bind_cols(betweenness = betweenness(g))
clusters_18_metrics %>%
bind_cols(betweenness = betweenness(g),
closeness = closeness(g)) -> clusters_18_metrics
library(ggplot2)
clusters_18_metrics %>%
ggplot(aes(x = betweenness, y = CL18_pop2010to2002_rel))+
geom_point()
clusters_18_metrics %>%
ggplot(aes(x = betweenness, y = CL18_pop2010to2002_rel))+
geom_point()+geom_smooth()
m <- read_csv("data/18clusters_matrix.csv") %>% .[,-1] %>% as.matrix()
load("data/Part3_res_dataset.Rdata")
g <- graph_from_adjacency_matrix(m, mode = "undirected")
clusters_18_metrics %>%
bind_cols(betweenness = betweenness(g, normalized = T),
closeness = closeness(g, normalized = T)) -> clusters_18_metrics
clusters_18_metrics %>%
ggplot(aes(x = betweenness, y = CL18_pop2010to2002_rel))+
geom_point()+geom_smooth(method =  )
clusters_18_metrics %>%
ggplot(aes(x = betweenness, y = CL18_pop2010to2002_rel))+
geom_point()+geom_smooth(method =  "glm")
clusters_18_metrics %>%
ggplot(aes(x = closeness, y = CL18_pop2010to2002_rel))+
geom_point()+geom_smooth(method =  "glm")
clusters_18_metrics %>%
ggplot(aes(x = closeness, y = CL18_variance_dif))+
geom_point()+geom_smooth(method =  "glm")
clusters_18_metrics %>%
ggplot(aes(x = betweenness, y = CL18_variance_dif))+
geom_point()+geom_smooth(method =  "glm")
lm(CL18_variance_dif~ betweenness + closeness, data = clusters_18_metrics) %>% summary()
clusters_18_metrics %>%
ggplot(aes(x = betweenness, y = CL18_variance_dif))+
geom_point()+geom_smooth(method =  "glm")
lm(CL18_variance_dif ~ betweenness, data = clusters_18_metrics) %>% summary()
lm(CL18_pop2010to2002_rel ~ betweenness, data = clusters_18_metrics) %>% summary()
lm(CL18_pop2010to2002_rel ~ betweenness + closeness, data = clusters_18_metrics) %>% summary()
lm(CL18_pop2010to2002_rel ~ betweenness*closeness, data = clusters_18_metrics) %>% summary()
lm(CL18_variance_dif ~ betweenness*closeness, data = clusters_18_metrics) %>% summary()
View(clusters_18_metrics)
library(lme)
library(lme4)
lmer(CL18_variance_dif ~ betweenness + closeness + (1|clust_18), data = clusters_18_metrics) %>% summary()
lm(CL18_variance_dif ~ betweenness*closeness, data = clusters_18_metrics) %>% summary()
clusters_18_metrics %>%
ggplot(aes(x = betweenness, y = CL18_variance_dif))+
geom_point()+geom_smooth(method =  "glm")
lmer(pop2010to2002_rel ~ btew_CL18 + clo_CL18 + (1 + clo_CL18|clust_18), data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18 + (1 + clo_CL18|clust_18), data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18 + (1|clust_18) + (0 + clo_CL18|clust_18), data = df) %>% summary()
library(lmerTest)
lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18 + (1|clust_18) + (0 + clo_CL18|clust_18), data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18 + (1 + clo_CL18|clust_18), data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18 + (1 + clo_CL18|clust_18), REML = F, data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18 + (1 + clo_CL18|clust_18), REML = F, data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18*clo_CL18 + (1 + clo_CL18|clust_18), REML = F, data = df) %>% summary()
lmer(pop2010to2002_rel ~ clo_CL18 + (1 + clo_CL18|clust_18), REML = F, data = df) %>% summary()
lmer(Census2002 ~ clo_CL18 + (1 + clo_CL18|clust_18), REML = F, data = df) %>% summary()
lmer(Census2010 ~ clo_CL18 + (1 + clo_CL18|clust_18), REML = F, data = df) %>% summary()
lmer(Census2010 ~ betw_CL18 + (1 + clo_CL18|clust_18), REML = F, data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + (1 + clo_CL18|clust_18), REML = F, data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + Census2002 + (1 + betw_CL18|clust_18), REML = F, data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + Census2002, REML = F, data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + Census2002 + (1|clust_18), REML = F, data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + (1|clust_18), REML = F, data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18+ (1|clust_18), REML = F, data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18+ (1 + clo_CL18|clust_18), REML = F, data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18_w+ (1 + clo_CL18|clust_18), REML = F, data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18_w + (1 + clo_CL18_w|clust_18), REML = F, data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + (1 + betw_CL18|clust_18), REML = F, data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18 + (1|clust_18), REML = F, data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + (1 + clo_CL18|clust_18), REML = F, data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18+ (1 + clo_CL18|clust_18), REML = F, data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18 + (1|clust_18), REML = F, data = df) %>% summary()
lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18 + (1|clust_18), REML = F, data = df %>% filter(pop2010to2002_rel < 150)) %>% summary()
cor(df$Census2002, df$clo_CL18, method = "spearman")
cor(df$Census2002, df$clo_CL18_w, method = "spearman")
cor(df$Census2002, df$clo_CL6, method = "spearman")
cor(df$Census2002, df$clo_CL6_18, method = "spearman")
cor(df$Census2002, df$clo_CL6, method = "spearman")
lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18 + (1|clust_18), REML = F, data = df %>% filter(pop2010to2002_rel < 150)) %>% summary()
?r.squared
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18 + (1|clust_18), REML = F, data = df %>% filter(pop2010to2002_rel < 150)) %>% summary()
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18 + (1|clust_18), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
MuMIn::r.squaredGLMM(test)
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18 + (1 + clust_18), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18 + (1 + betw_CL18|clust_18), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
test
summary(test)
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18 + (1 + clo_CL18|clust_18), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
MuMIn::r.squaredGLMM(test)
test <- lmer(pop2010to2002_rel ~ betw_CL18 + (1 + betw_CL18|clust_18), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
MuMIn::r.squaredGLMM(test)
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18 + (1 + clo_CL18|clust_18), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
MuMIn::r.squaredGLMM(test)
MuMIn::r.squaredGLMM(test)
test <- lmer(pop2010to2002_rel ~ betw_CL6 + clo_CL18 + (1 + clo_CL18|clust_18), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
MuMIn::r.squaredGLMM(test)
test <- lmer(pop2010to2002_rel ~ betw_CL6 + clo_CL6 + (1 + clo_CL6|clust_6), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
MuMIn::r.squaredGLMM(test)
test <- lmer(pop2010to2002_rel ~ betw_CL6 + clo_CL6 + (1 + clo_CL6|clust_6) + (1 + betw_CL6|clust_6), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
MuMIn::r.squaredGLMM(test)
test <- lmer(pop2010to2002_rel ~ betw_CL6 + clo_CL6 + (1 + clo_CL6|clust_6), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
MuMIn::r.squaredGLMM(test)
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL6 + (1 + clo_CL6|clust_6), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
MuMIn::r.squaredGLMM(test)
test <- lmer(pop2010to2002_rel ~ betw_CL18*clo_CL6 + (1 + clo_CL6|clust_6), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
MuMIn::r.squaredGLMM(test)
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL6 + (1 + clo_CL6|clust_6/clust_18), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
MuMIn::r.squaredGLMM(test)
test <- lmer(pop2010to2002_rel ~ betw_CL6 + clo_CL6 + (1 + clo_CL6|clust_6/clust_18), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
MuMIn::r.squaredGLMM(test)
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL6 + (1 + clo_CL6|clust_6/clust_18), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
MuMIn::r.squaredGLMM(test)
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL6 + (1 + clo_CL6|clust_6/clust_18), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
qqplot(df$pop2010to2002_rel, predict(test))
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL6 + (1 + clo_CL6|clust_6/clust_18), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL6 + (1 + clo_CL6|clust_6/clust_18), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
summary(test)
MuMIn::r.squaredGLMM(test)
MuMIn::r.squaredGLMM(test)
qqplot(df$pop2010to2002_rel, predict(test))
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6/clust_18), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
MuMIn::r.squaredGLMM(test)
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
MuMIn::r.squaredGLMM(test)
test <- lmer(pop2010to2002_rel ~ betw_CL6 + clo_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
MuMIn::r.squaredGLMM(test)
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL6 + (1|clust_6:clust_18) + (0 + clo_CL6|clust_6), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
MuMIn::r.squaredGLMM(test)
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
MuMIn::r.squaredGLMM(test)
df %>%
ggplot(aes(y = pop2010to2002_rel, x =  clo_CL6))+
geom_point()+
facet_grid(.~clust_6)
df %>%
ggplot(aes(y = pop2010to2002_rel, x =  clo_CL6))+
geom_point()+
geom_smooth(method = "glm")+
facet_wrap(.~clust_6)
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL18 + (1|clust_6/clust_18) + (0 + clo_CL18|clust_18), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
MuMIn::r.squaredGLMM(test)
# .....
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
MuMIn::r.squaredGLMM(test)
# .....
test <- lmer(pop2010to2002_rel ~ betw_CL18*clo_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
summary(test)
MuMIn::r.squaredGLMM(test)
# .....
test <- lmer(pop2010to2002_rel ~ betw_CL18 + clo_CL6 + (1|clust_6/clust_18) + (0 + clo_CL6|clust_6), REML = F, data = df %>% filter(pop2010to2002_rel < 150))
MuMIn::r.squaredGLMM(test)
qqplot(df$pop2010to2002_rel, predict(test))
df %>%
ggplot(aes(y = pop2010to2002_rel, x =  clo_CL6))+
geom_point()+
geom_smooth(method = "glm")+
facet_wrap(.~clust_6)
df %>%
ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, col = clust_6))+
geom_point()+
geom_smooth(method = "glm")
df %>%
ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, col = as.factor(clust_6)))+
geom_point()+
geom_smooth(method = "glm")
df %>%
ggplot(aes(y = pop2010to2002_rel, x = betw_CL18, col = as.factor(clust_6)))+
geom_point()+
geom_smooth(method = "glm")
df %>%
ggplot(aes(y = pop2010to2002_rel, x = betw_CL18))+
geom_point()+
geom_smooth(method = "glm")
df %>%
ggplot(aes(y = pop2010to2002_rel, x = betw_CL18, col = as.factor(clust_6)))+
geom_point()+
geom_smooth(method = "glm")
df %>%
ggplot(aes(y = pop2010to2002_rel, x = betw_CL18))+
geom_point()+
geom_smooth(method = "glm")
df %>%
ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, col = as.factor(clust_6)))+
geom_point()+
geom_smooth(method = "glm")
summary(test)
g_vis <- toVisNetworkData(g)
visNetwork(g_vis)
visNetwork(g_vis$nodes, g_vis$edges)
g_vis
g_vis %>% str()
# Convert to visNetwork list
g_vis <- toVisNetworkData(g)
# Plot graph
visNetwork(g_vis$nodes, g_vis$edges)
?betweenness
?visNetwork
g_vis$nodes
visNetwork(g_vis$nodes %>% bind_cols(value = betweenness(g, normalized = T)), g_vis$edges)
# Load adjacency_matrix
m <- read_csv("data/18clusters_matrix.csv") %>% .[,-1] %>% as.matrix()
# Create igraph object
g <- graph_from_adjacency_matrix(m, mode = "undirected")
# Convert to visNetwork list
g_vis <- toVisNetworkData(g)
# Plot graph
visNetwork(g_vis$nodes, g_vis$edges)
# Load clusters metrics
load("data/Part3_res_dataset.Rdata")
# Calculate centrality measures and add to data frame
clusters_18_metrics %>%
bind_cols(betweenness = betweenness(g, normalized = T),
closeness = closeness(g, normalized = T),
degree = degree(g, normalized = T)) -> clusters_18_metrics
# Load clusters metrics
load("data/Part3_res_dataset.Rdata")
# Calculate centrality measures and add to data frame
clusters_18_metrics %>%
bind_cols(betweenness = betweenness(g, normalized = T),
closeness = closeness(g, normalized = T),
degree = degree(g, normalized = T)) %>%
select(clust_18, CL18_pop2010to2002_rel, degree,  closeness, betweenness) -> clusters_18_metrics
load("data/Part3_res_dataset.Rdata")
# Calculate centrality measures and add to data frame
clusters_18_metrics %>%
bind_cols(betweenness = betweenness(g, normalized = T),
closeness = closeness(g, normalized = T),
degree = degree(g, normalized = T)) %>%
select(clust_18, CL18_pop2010to2002_rel, CL18_variance_dif, degree, closeness, betweenness) -> clusters_18_metrics
clusters_18_metrics %>%
gather(Measure, Value, degree:betweenness) %>%
ggplot(aes(x = Value, y = CL18_variance_dif))+
geom_point()+
geom_smooth(method =  "glm")+
facet_wrap(.~Measure)
clusters_18_metrics %>%
gather(Measure, Value, degree:betweenness) %>%
ggplot(aes(x = Value, y = CL18_variance_dif))+
geom_point()+
geom_smooth(method =  "glm")+
facet_wrap(.~Measure)
# lm(CL18_variance_dif ~ betweenness + closeness, data = clusters_18_metrics) %>% summary()
#
#
#
#
# df %>%
#   ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, col = as.factor(clust_6)))+
#   geom_point()+
#   geom_smooth(method = "glm")
#
#
# df %>%
#   ggplot(aes(y = pop2010to2002_rel, x = betw_CL18))+
#   geom_point()+
#   geom_smooth(method = "glm")
#
#
# df
# Load clusters metrics
load("data/Part3_res_dataset.Rdata")
# Calculate centrality measures and add to data frame
clusters_18_metrics %>%
bind_cols(betweenness = betweenness(g),
closeness = closeness(g),
degree = degree(g)) %>%
select(clust_18, CL18_pop2010to2002_rel, CL18_variance_dif, degree, closeness, betweenness) -> clusters_18_metrics
clusters_18_metrics %>%
gather(Measure, Value, degree:betweenness) %>%
ggplot(aes(x = Value, y = CL18_variance_dif))+
geom_point()+
geom_smooth(method =  "glm")+
facet_wrap(.~Measure)
# lm(CL18_variance_dif ~ betweenness + closeness, data = clusters_18_metrics) %>% summary()
#
#
#
#
# df %>%
#   ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, col = as.factor(clust_6)))+
#   geom_point()+
#   geom_smooth(method = "glm")
#
#
# df %>%
#   ggplot(aes(y = pop2010to2002_rel, x = betw_CL18))+
#   geom_point()+
#   geom_smooth(method = "glm")
#
#
# df
# Load clusters metrics
load("data/Part3_res_dataset.Rdata")
# Calculate centrality measures and add to data frame
clusters_18_metrics %>%
bind_cols(betweenness = betweenness(g, normalized = T),
closeness = closeness(g, normalized = T),
degree = degree(g, normalized = T)) %>%
select(clust_18, CL18_pop2010to2002_rel, CL18_variance_dif, degree, closeness, betweenness) -> clusters_18_metrics
clusters_18_metrics %>%
gather(Measure, Value, degree:betweenness) %>%
ggplot(aes(x = Value, y = CL18_variance_dif))+
geom_point()+
geom_smooth(method =  "glm")+
facet_wrap(.~Measure)
# lm(CL18_variance_dif ~ betweenness + closeness, data = clusters_18_metrics) %>% summary()
#
#
#
#
# df %>%
#   ggplot(aes(y = pop2010to2002_rel, x = clo_CL6, col = as.factor(clust_6)))+
#   geom_point()+
#   geom_smooth(method = "glm")
#
#
# df %>%
#   ggplot(aes(y = pop2010to2002_rel, x = betw_CL18))+
#   geom_point()+
#   geom_smooth(method = "glm")
#
#
# df
clusters_18_metrics %>%
gather(Measure, Value, degree:betweenness) %>%
ggplot(aes(x = Value, y = CL18_variance_dif, col = Measure))+
geom_point()+
geom_smooth(method =  "glm")
clusters_18_metrics %>%
gather(Measure, Value, degree:betweenness) %>%
ggplot(aes(x = Value, y = CL18_pop2010to2002_rel, col = Measure))+
geom_point()+
geom_smooth(method =  "glm")
clusters_18_metrics %>%
gather(Measure, Value, degree:betweenness) %>%
ggplot(aes(x = Value, y = CL18_pop2010to2002_rel, col = Measure))+
geom_point()+
geom_smooth(method =  "glm")+facet_wrap(.~Meassure)
clusters_18_metrics %>%
gather(Measure, Value, degree:betweenness) %>%
ggplot(aes(x = Value, y = CL18_pop2010to2002_rel, col = Measure))+
geom_point()+
geom_smooth(method =  "glm")+facet_wrap(.~Measure)
clusters_18_metrics %>%
gather(Measure, Value, degree:betweenness) %>%
ggplot(aes(x = Value, y = CL18_variance_dif, col = Measure))+
geom_point()+
geom_smooth(method =  "glm")+facet_wrap(.~Measure)
library(corrplot)
corrplot(clusters_18_metrics[,c("degree", "betweenness")])
corrplot(clusters_18_metrics[,4:6)
corrplot(clusters_18_metrics[,4:6])
corrplot(clusters_18_metrics[,c(4,5,6)])
clusters_18_metrics[,c(4,5,6)]
corrplot(clusters_18_metrics)
?corplot
?corrplot
corrplot(cor(clusters_18_metrics %>% select(-clust_18)))
clusters_18_metrics %>% select(-clust_18)
corrplot(cor(clusters_18_metrics %>% dplyr::select(-clust_18)))
corrplot(cor(clusters_18_metrics %>% dplyr::select(-clust_18)), method = "number")
clusters_18_metrics %>%
gather(Measure, Value, degree:betweenness) %>%
ggplot(aes(x = Value, y = CL18_variance_dif, col = Measure))+
geom_point()+
geom_smooth(method =  "glm")+facet_wrap(.~Measure)
clusters_18_metrics %>%
gather(Measure, Value, degree:betweenness) %>%
ggplot(aes(x = Value, y = CL18_pop2010to2002_rel, col = Measure))+
geom_point()+
geom_smooth(method =  "glm")+facet_wrap(.~Measure)
?cor()
cor(clusters_18_metrics$CL18_pop2010to2002_rel, clusters_18_metrics$CL18_variance_dif, method = "spearman")
cor(clusters_18_metrics$CL18_pop2010to2002_rel, clusters_18_metrics$CL18_variance_dif, method = "kendall")
cor(clusters_18_metrics$CL18_pop2010to2002_rel, clusters_18_metrics$CL18_variance_dif, method = "pearson")
corrplot(cor(clusters_18_metrics %>% dplyr::select(-clust_18)), method = "number")
lm(CL18_variance_dif ~ betweenness, data = clusters_18_metrics) %>% summary()
lm(CL18_variance_dif ~ degree, data = clusters_18_metrics) %>% summary()
lm(CL18_variance_dif ~ closeness, data = clusters_18_metrics) %>% summary()
library(stargazer)
model_degree <- lm(CL18_variance_dif ~ degree, data = clusters_18_metrics)
summary(model_degree)
model_closeness <- lm(CL18_variance_dif ~ closeness, data = clusters_18_metrics)
summary(model_closeness)
model_betweenness <- lm(CL18_variance_dif ~ betweenness, data = clusters_18_metrics)
summary(model_betweenness)
stargazer(model_degree, model_closeness, model_betweenness,
type = "text"
# dep.var.labels   = "Annual population trend, %",
# covariate.labels = c("Dairy cattle, '000", "Overal sown area, '0000 ha", "Yield cereals, t/ha",
#                      "Distance to regional capital, 100 km"),
# column.labels = c("1991-2000 RE model", "2001-2010 FE model")
)
summary(model_closeness)
# Динамика населения
model_pop_degree <- lm(CL18_pop2010to2002_rel ~ degree, data = clusters_18_metrics)
model_pop_closeness <- lm(CL18_pop2010to2002_rel ~ closeness, data = clusters_18_metrics)
model_pop_betweenness <- lm(CL18_pop2010to2002_rel ~ betweenness, data = clusters_18_metrics)
# Сжатие расселения
model_var_degree <- lm(CL18_variance_dif ~ degree, data = clusters_18_metrics)
model_var_closeness <- lm(CL18_variance_dif ~ closeness, data = clusters_18_metrics)
model_var_betweenness <- lm(CL18_variance_dif ~ betweenness, data = clusters_18_metrics)
stargazer(model_pop_degree, model_pop_closeness, model_pop_betweenness, model_var_degree, model_var_closeness,
model_var_betweenness,
type = "text",
dep.var.labels   = c("Annual population trend, %", "ccd")
# covariate.labels = c("Dairy cattle, '000", "Overal sown area, '0000 ha", "Yield cereals, t/ha",
#                      "Distance to regional capital, 100 km"),
# column.labels = c("1991-2000 RE model", "2001-2010 FE model")
)
stargazer(model_pop_degree, model_pop_closeness, model_pop_betweenness, model_var_degree, model_var_closeness,
model_var_betweenness,
type = "text",
dep.var.labels   = c("Динамика населения, %", "Сжатие расселения (отношение вариации, %)"))
model_pop_degree
model_pop_degree %>% summary()
stargazer(model_pop_degree, model_pop_closeness, model_pop_betweenness, model_var_degree, model_var_closeness,
model_var_betweenness,
type = "text",
dep.var.labels   = c("Динамика населения, %", "Сжатие расселения (динамика вариации, %)"))
clusters_18_metrics %>%
ggplot(aes(CL18_pop2010to2002_rel))+
geom_histogram()
clusters_18_metrics %>%
ggplot(aes(CL18_pop2010to2002_rel))+
geom_density()
clusters_18_metrics %>%
ggplot(aes(CL18_variance_dif))+
geom_density()
?lm
clusters_18_metrics %>%
ggplot(aes(CL18_variance_dif))+
geom_histogram()
?glm
corrplot(cor(clusters_18_metrics %>% dplyr::select(-clust_18)), method = "number")
?visNetwork
visIgraph(g)
