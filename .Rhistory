geom_point(aes(size = Census2002), alpha = 0.4)+
geom_smooth(method = "glm", se = F, span = 0.2)+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 10))+
# scale_y_continuous(name = "Центральность по посредничеству (98.2 км)",
#                    breaks = seq(-2, 6, 1))+
# scale_x_continuous(name = "Расстояние до Тюмени, км",
#                    limits = c(0, 500),
#                    breaks = seq(0, 500, 50),
#                    minor_breaks = seq(0 , 500, 50))+
# scale_fill_viridis_c(option = "E", breaks = 1:10)+
theme_bw(base_size = 14, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)
# Color show the density (count) of points
df_cleaned %>%
ggplot(aes(x = dist2Tyumen/1000, y = clo_CL6, col = as.factor(clust_6)))+
geom_point(aes(size = Census2002), alpha = 0.4)+
geom_smooth(method = "glm", se = F, span = 0.2)+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 10))+
# scale_y_continuous(name = "Центральность по посредничеству (98.2 км)",
#                    breaks = seq(-2, 6, 1))+
# scale_x_continuous(name = "Расстояние до Тюмени, км",
#                    limits = c(0, 500),
#                    breaks = seq(0, 500, 50),
#                    minor_breaks = seq(0 , 500, 50))+
# scale_fill_viridis_c(option = "E", breaks = 1:10)+
theme_bw(base_size = 14, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)+
facet_wrap(.~clust_6)
# Color show the density (count) of points
df_cleaned %>%
ggplot(aes(x = dist2Tyumen/1000, y = clo_CL6, col = as.factor(clust_6)))+
geom_point(aes(size = Census2002), alpha = 0.4)+
geom_smooth(method = "glm", se = F, span = 0.2)+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 10))+
# scale_y_continuous(name = "Центральность по посредничеству (98.2 км)",
#                    breaks = seq(-2, 6, 1))+
# scale_x_continuous(name = "Расстояние до Тюмени, км",
#                    limits = c(0, 500),
#                    breaks = seq(0, 500, 50),
#                    minor_breaks = seq(0 , 500, 50))+
# scale_fill_viridis_c(option = "E", breaks = 1:10)+
theme_bw(base_size = 14, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)
# Color show the density (count) of points
df_cleaned %>%
ggplot(aes(x = dist2Tyumen/1000, y = clo_CL6, col = as.factor(clust_6)))+
geom_point(aes(size = Census2002), alpha = 0.4)+
geom_smooth(method = "glm", se = F, span = 0.2)+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 10))+
# scale_y_continuous(name = "Центральность по посредничеству (98.2 км)",
#                    breaks = seq(-2, 6, 1))+
scale_x_continuous(name = "Расстояние до Тюмени, км",
limits = c(0, 500),
breaks = seq(0, 500, 50),
minor_breaks = seq(0 , 500, 50))+
# scale_fill_viridis_c(option = "E", breaks = 1:10)+
theme_bw(base_size = 14, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)
# Color show the density (count) of points
df_cleaned %>%
ggplot(aes(x = dist2Tyumen/1000, y = clo_CL6, col = as.factor(clust_6)))+
geom_point(aes(size = Census2002), alpha = 0.4)+
geom_smooth(method = "glm", se = F, span = 0.2)+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 10))+
scale_y_continuous(name = "Центральность по близости (6)",
breaks = seq(-2, 4, 1))+
scale_x_continuous(name = "Расстояние до Тюмени, км",
limits = c(0, 500),
breaks = seq(0, 500, 50),
minor_breaks = seq(0 , 500, 50))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 14, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)
# А как связана центральность
df_cleaned %>%
ggplot(aes(x = dist2Tyumen/1000, y = clo_CL6, col = as.factor(clust_6)))+
geom_point(aes(size = Census2002), alpha = 0.5)+
geom_smooth(method = "glm", se = F, span = 0.2)+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 10))+
scale_y_continuous(name = "Центральность по близости (6)",
breaks = seq(-2, 4, 1))+
scale_x_continuous(name = "Расстояние до Тюмени, км",
limits = c(0, 500),
breaks = seq(0, 500, 50),
minor_breaks = seq(0 , 500, 50))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 14, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)
# А как связана центральность
df_cleaned %>%
ggplot(aes(x = dist2Tyumen/1000, y = clo_CL6, col = as.factor(clust_6)))+
geom_point(aes(size = Census2002), alpha = 0.4)+
geom_smooth(method = "glm", se = F, span = 0.2)+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 12))+
scale_y_continuous(name = "Центральность по близости (6)",
breaks = seq(-2, 4, 1))+
scale_x_continuous(name = "Расстояние до Тюмени, км",
limits = c(0, 500),
breaks = seq(0, 500, 50),
minor_breaks = seq(0 , 500, 50))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 14, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)
# А как связана центральность по близости с удаленностью от Тюмени?
df_cleaned %>%
ggplot(aes(x = dist2Tyumen/1000, y = clo_CL18, col = as.factor(clust_18)))+
geom_point(aes(size = Census2002), alpha = 0.4)+
geom_smooth(method = "glm", se = F, span = 0.2)+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 12))+
scale_y_continuous(name = "Центральность по близости (6)",
breaks = seq(-2, 4, 1))+
scale_x_continuous(name = "Расстояние до Тюмени, км",
limits = c(0, 500),
breaks = seq(0, 500, 50),
minor_breaks = seq(0 , 500, 50))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 14, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)
# А как связана центральность по близости с удаленностью от Тюмени?
df_cleaned %>%
ggplot(aes(x = dist2Tyumen/1000, y = clo_CL18, col = as.factor(clust_18)))+
geom_point(aes(size = Census2002), alpha = 0.4)+
geom_smooth(method = "glm", se = F, span = 0.2)+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 12))+
scale_y_continuous(name = "Центральность по близости (6)",
breaks = seq(-2, 4, 1))+
scale_x_continuous(name = "Расстояние до Тюмени, км",
limits = c(0, 500),
breaks = seq(0, 500, 50),
minor_breaks = seq(0 , 500, 50))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 14, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)
# А как связана центральность по близости с удаленностью от Тюмени?
df_cleaned %>%
ggplot(aes(x = dist2Tyumen/1000, y = clo_CL18, col = as.factor(clust_18)))+
geom_point(aes(size = Census2002), alpha = 0.4)+
geom_smooth(method = "glm", se = F, span = 0.2)+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 12))+
scale_y_continuous(name = "Центральность по близости (6)",
breaks = seq(-2, 4, 1))+
scale_x_continuous(name = "Расстояние до Тюмени, км",
limits = c(0, 500),
breaks = seq(0, 500, 50),
minor_breaks = seq(0 , 500, 50))+
# scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 14, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)
# А как связана центральность по близости с удаленностью от Тюмени?
df_cleaned %>%
ggplot(aes(x = clo_CL18, y = Census2002, col = as.factor(clust_18)))+
geom_point(aes(size = Census2002), alpha = 0.4)+
geom_smooth(method = "glm", se = F, span = 0.2)+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 12))+
# scale_y_continuous(name = "Центральность по близости (6)",
#                    breaks = seq(-2, 4, 1))+
# scale_x_continuous(name = "Расстояние до Тюмени, км",
#                    limits = c(0, 500),
#                    breaks = seq(0, 500, 50),
#                    minor_breaks = seq(0 , 500, 50))+
# scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 14, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)
# А как связана центральность по близости с удаленностью от Тюмени?
df_cleaned %>%
ggplot(aes(x = clo_CL18, y = logPop, col = as.factor(clust_18)))+
geom_point(aes(size = Census2002), alpha = 0.4)+
geom_smooth(method = "glm", se = F, span = 0.2)+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 12))+
# scale_y_continuous(name = "Центральность по близости (6)",
#                    breaks = seq(-2, 4, 1))+
# scale_x_continuous(name = "Расстояние до Тюмени, км",
#                    limits = c(0, 500),
#                    breaks = seq(0, 500, 50),
#                    minor_breaks = seq(0 , 500, 50))+
# scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 14, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)
# А как связана центральность по близости с удаленностью от Тюмени?
df_cleaned %>%
ggplot(aes(x = clo_CL18, y = logPop))+
geom_point(aes(size = Census2002, col = as.factor(clust_18)), alpha = 0.4)+
geom_smooth(method = "glm", se = F, span = 0.2, col = "red")+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 12))+
# scale_y_continuous(name = "Центральность по близости (6)",
#                    breaks = seq(-2, 4, 1))+
# scale_x_continuous(name = "Расстояние до Тюмени, км",
#                    limits = c(0, 500),
#                    breaks = seq(0, 500, 50),
#                    minor_breaks = seq(0 , 500, 50))+
# scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 14, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)
# А как связана центральность по близости с удаленностью от Тюмени?
df_cleaned %>%
ggplot(aes(x = clo_CL6, y = logPop))+
geom_point(aes(size = Census2002, col = as.factor(clust_6)), alpha = 0.4)+
geom_smooth(method = "glm", se = F, span = 0.2, col = "red")+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 12))+
# scale_y_continuous(name = "Центральность по близости (6)",
#                    breaks = seq(-2, 4, 1))+
# scale_x_continuous(name = "Расстояние до Тюмени, км",
#                    limits = c(0, 500),
#                    breaks = seq(0, 500, 50),
#                    minor_breaks = seq(0 , 500, 50))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 14, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)
# А как связана центральность по близости с удаленностью от Тюмени?
df_cleaned %>%
ggplot(aes(x = clo_CL6, y = logPop, col = as.factor(clust_6)))+
geom_point(aes(size = Census2002), alpha = 0.4)+
geom_smooth(method = "glm", se = F, span = 0.2, col = "red")+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 12))+
# scale_y_continuous(name = "Центральность по близости (6)",
#                    breaks = seq(-2, 4, 1))+
# scale_x_continuous(name = "Расстояние до Тюмени, км",
#                    limits = c(0, 500),
#                    breaks = seq(0, 500, 50),
#                    minor_breaks = seq(0 , 500, 50))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 14, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)
# А как связана центральность по близости с удаленностью от Тюмени?
df_cleaned %>%
ggplot(aes(x = clo_CL6, y = logPop, col = as.factor(clust_6)))+
geom_point(aes(size = Census2002), alpha = 0.4)+
geom_smooth(method = "glm", se = F, span = 0.2)+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 12))+
# scale_y_continuous(name = "Центральность по близости (6)",
#                    breaks = seq(-2, 4, 1))+
# scale_x_continuous(name = "Расстояние до Тюмени, км",
#                    limits = c(0, 500),
#                    breaks = seq(0, 500, 50),
#                    minor_breaks = seq(0 , 500, 50))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 14, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)
# А как связана центральность по близости с удаленностью от Тюмени?
df_cleaned %>%
ggplot(aes(x = dist2Tyumen/1000, y = clo_CL6, col = as.factor(clust_6)))+
geom_point(aes(size = Census2002), alpha = 0.4)+
geom_smooth(method = "glm", se = F, span = 0.2)+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 12))+
scale_y_continuous(name = "Центральность по близости (6)",
breaks = seq(-2, 4, 1))+
scale_x_continuous(name = "Расстояние до Тюмени, км",
limits = c(0, 500),
breaks = seq(0, 500, 50),
minor_breaks = seq(0 , 500, 50))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 14, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)
# А как связана центральность по близости с удаленностью от Тюмени?
fig_closeness_vs_distance2Tyumen <- df_cleaned %>%
ggplot(aes(x = dist2Tyumen/1000, y = clo_CL6, col = as.factor(clust_6)))+
geom_point(aes(size = Census2002), alpha = 0.4)+
geom_smooth(method = "glm", se = F, span = 0.2)+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 12))+
scale_y_continuous(name = "Центральность по близости (6)",
breaks = seq(-2, 4, 1))+
scale_x_continuous(name = "Расстояние до Тюмени, км",
limits = c(0, 500),
breaks = seq(0, 500, 50),
minor_breaks = seq(0 , 500, 50))+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
theme_bw(base_size = 14, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)
# Сохраним рисунок
ggsave(plot = fig_closeness_vs_distance2Tyumen, filename = "fig_closeness_vs_distance2Tyumen.jpeg",
device = "jpeg", path = "plots/",
dpi = 300, width = 14, height = 14, units = "cm")
# Сохраним рисунок
ggsave(plot = fig_closeness_vs_distance2Tyumen, filename = "fig_closeness_vs_distance2Tyumen.jpeg",
device = "jpeg", path = "plots/",
dpi = 300, width = 16, height = 14, units = "cm")
# colnames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%","log(числ. нас-я, 2002)", "ЦБ(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)")
# rownames(corr) <- c("Динамика числ. нас-я\n(2010 к 2002),%","log(числ. нас-я, 2002)", "Ц0Б(6)", "ЦБ(18)", "ЦП(98)", "ЦП(52)")
corrplot(corr, method = "number", type = "full", insig = "p-value", col = viridis::inferno(12))
df_cleaned %>%
ggplot(aes(x = dist2Tyumen/1000, y = betw_CL6))+
geom_point(aes(size = Census2002, col = as.factor(clust_6)), alpha = 0.4)+
geom_smooth(method = "glm", se = F, span = 0.2, col = "red")+
annotate("text", x = 400, y = 4, label = "r = -0.19")+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 10))+
scale_y_continuous(name = "Центральность по посредничеству",
breaks = seq(-2, 6, 1))+
scale_x_continuous(name = "Расстояние до Тюмени, км",
limits = c(0, 500),
breaks = seq(0, 500, 50),
minor_breaks = seq(0 , 500, 50))+
theme_bw(base_size = 12, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)
fig_closeness_vs_distance2Tyumen
df_cleaned %>%
ggplot(aes(x = dist2Tyumen/1000, y = betw_CL6))+
geom_point(aes(size = Census2002, col = as.factor(clust_6)), alpha = 0.4)+
geom_smooth(method = "glm", se = F, span = 0.2, col = "red")+
annotate("text", x = 400, y = 4, label = "r = -0.19")+
scale_colour_manual(name = "Кластер", values = brewer.pal(n = 6, name = "Dark2"))+
scale_size_continuous(name = "Население (2002), тыс. чел.",
breaks = rev(c(0, 100, 1000, 5000, 20000, 100000)),
labels = rev(c("< 0.1", "0.1-1", "1-5", "5-20", "20-100", ">100")),
range = c(0.9, 10))+
scale_y_continuous(name = "Центральность по посредничеству",
breaks = seq(-2, 6, 1))+
scale_x_continuous(name = "Расстояние до Тюмени, км",
limits = c(0, 500),
breaks = seq(0, 500, 50),
minor_breaks = seq(0 , 500, 50))+
theme_bw(base_size = 12, base_family = "Arial")+
theme(panel.grid = element_blank(),
axis.ticks = element_line(),
legend.position = "bottom",
# legend.direction = "horizontal",
legend.title = element_text(size = 12),
plot.margin=unit(c(0.1,0.1,0.1,0.1),"cm"))+
guides(colour = guide_legend(title.position = "top", nrow = 1),
size = F)
Fig_dist2Tyumen_vs_betw
fig_closeness_vs_distance2Tyumen
